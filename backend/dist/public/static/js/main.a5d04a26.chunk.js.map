{"version":3,"sources":["reducers/canvasReducer.tsx","components/Grid.tsx","components/Tile.tsx","utils/tileMapping.ts","services/tileSets.ts","components/Canvas.tsx","reducers/brushReducer.tsx","components/Tools/Eraser.tsx","components/Tools/Undo.tsx","components/Tools/Redo.tsx","services/mapsService.ts","reducers/mapsReducer.tsx","components/Tools/Save.tsx","components/Tools/Load.tsx","components/Tools/Palette.tsx","components/Tools/index.tsx","components/ToolBar.tsx","components/MapCard.tsx","components/Maps.tsx","components/Tools/Settings.tsx","components/Tools/Edit.tsx","reducers/userReducer.tsx","components/Login.tsx","components/Logout.tsx","components/TopBar.tsx","App.tsx","reducers/tileSetReducer.tsx","store.tsx","index.tsx","tileSets/revolution_tiles.png","tileSets/bw_tiles.png"],"names":["nullState","tileMap","name","width","height","history","Array","fill","current","newState","map","paint","state","position","newTile","newMap","oldTile","index","slice","load","type","data","updateMap","canvasReducer","action","target","tile","console","log","length","updatedTileMap","Grid","children","columns","rows","tileHeight","tileWidth","scale","classes","makeStyles","theme","createStyles","gridContainer","display","gridTemplateColumns","gridTemplateRows","transformOrigin","transform","cursor","useStyles","className","React","child","Tile","image","color","posX","posY","backgroundImage","backgroundColor","backgroundPosition","imageRendering","computeTilesPerRow","imageWidth","Math","floor","getPosY","tilesPerRow","getPosX","getTileProps","imageHeight","getPos","getMapping","tiles","n","Harbour","cityImage","tilesPerColumn","mapping","Cave","caveImage","tileSets","Canvas","dispatch","useDispatch","canvas","useSelector","brush","tools","tileSetName","tileSet","paintTile","key","onMouseDown","onMouseEnter","event","nativeEvent","which","getColor","initialState","setTile","setBrush","brushReducer","Eraser","onClick","IconButton","icon","eraserIcon","url","saveMap","token","id","axios","put","headers","Authorization","then","response","post","deleteMap","delete","getAll","get","mapsReducer","maps","deletedMapId","filter","savedMap","reduce","prevValue","i","concat","Save","user","appendMap","disabled","Load","useHistory","push","window","top","left","Palette","open","setOpen","Modal","onClose","Tools","List","tool","ListItem","root","appBar","zIndex","drawer","flexShrink","title","flexGrow","marginRight","content","margin","toolbarMargin","mixins","toolbar","ToolBar","Drawer","variant","mapThumbnail","overflow","alignItems","justifyContent","MapCard","Card","CardActionArea","CardMedia","parseMap","CardContent","Typography","CardActions","Button","component","Link","to","cutMap","removeMap","mapList","Maps","useEffect","mapsService","form","gridGap","background","padding","Settings","useState","setName","setWidth","setHeight","setTileSet","TextField","label","defaultValue","onChange","value","Number","parseInt","FormControl","InputLabel","Select","labelId","handleChange","Object","keys","MenuItem","preventDefault","handleSave","handleCreateNew","Edit","userReducer","Login","responseGoogle","error","googleId","profileObj","accessToken","clientId","buttonText","onSuccess","onFailure","cookiePolicy","isSignedIn","Logout","onLogoutSuccess","TopBar","mapName","AppBar","Toolbar","container","direction","justify","item","xs","exact","path","align","style","textAlign","App","tileSetReducer","reducer","combineReducers","store","createStore","composeWithDevTools","applyMiddleware","thunk","getState","render","ReactDOM","document","getElementById","subscribe","module","exports"],"mappings":"wOAoBMA,EAAY,CAChBC,QAAS,CACPC,KAAM,UACNC,MAAO,GACPC,OAAQ,GACRH,QAAS,IAEXI,QAAS,CAAC,IAAIC,MAAM,KAAOC,MAAM,IACjCC,QAAS,GAGLC,EAAW,SAACC,GAChB,MAAO,CACLT,QAASS,EACTL,QAAS,CAACK,EAAIT,SACdO,QAAS,IAIb,SAASG,EAAMC,EAAoBC,EAAkBC,GACnD,IACMC,EADaH,EAAMP,QAAQO,EAAMJ,SACbE,KAAI,SAACM,EAASC,GAAV,OAAqBA,IAAUJ,EAAWC,EAAUE,KAC5EX,EAAO,sBAAOO,EAAMP,QAAQa,MAAM,EAAGN,EAAMJ,QAAU,IAA9C,CAAkDO,IACzDP,EAAUI,EAAMJ,QAAU,EAChC,OAAO,eAAKI,EAAZ,CAAmBP,UAASG,YAwDvB,SAASW,EAAKlB,GACnB,MAAO,CACLmB,KAAM,WACNC,KAAM,CACJpB,YAKC,SAASqB,EAAUZ,GACxB,MAAO,CACLU,KAAM,aACNC,KAAM,CACJpB,QAASS,IAKAa,MAvEf,WAAkG,IAAD,MAA1EX,EAA0E,uDAArDZ,EAAkBwB,EAAmC,uCAC/F,OAAQA,EAAOJ,MACb,IAAK,WACH,OAAO,UAAAI,EAAOH,YAAP,eAAapB,SAAUQ,EAASe,EAAOH,KAAKpB,SAAWW,EAChE,IAAK,WACH,OAAO,UAAAY,EAAOH,YAAP,eAAaI,QAASd,EAAMC,EAAOY,EAAOH,KAAKI,OAAOR,MAAOO,EAAOH,KAAKI,OAAOC,MAAQd,EACjG,IAAK,OACH,OAAsB,IAAlBA,EAAMJ,QAAsBI,GAChCe,QAAQC,IAAI,cACL,eAAKhB,EAAZ,CAAmBJ,QAASI,EAAMJ,QAAU,KAC9C,IAAK,OACH,OAAII,EAAMJ,UAAYI,EAAMP,QAAQwB,OAAS,EAAUjB,EAChD,eAAKA,EAAZ,CAAmBJ,QAASI,EAAMJ,QAAU,IAC9C,IAAK,aACH,IAAMsB,EAAc,UAAGN,EAAOH,YAAV,aAAG,EAAapB,QACpC,IAAK6B,EAAgB,OAAOlB,EAE5Be,QAAQC,IAAI,mBAAoBE,GAChC,IAAIzB,EAAUO,EAAMP,QAChBG,EAAUI,EAAMJ,QAKpB,OAJIsB,EAAe3B,QAAUS,EAAMX,QAAQE,OAAS2B,EAAe1B,SAAWQ,EAAMX,QAAQG,SAC1FC,EAAU,CAAC,IAAIC,MAAMwB,EAAe3B,MAAQ2B,EAAe1B,QAAQG,MAAM,IACzEC,EAAU,GAEL,eAAKI,EAAZ,CAAmBX,QAAS6B,EAAgBzB,UAASG,YACvD,QACE,OAAOI,I,kBC1BEmB,MAnCf,YAEW,IADTC,EACQ,EADRA,SAAUC,EACF,EADEA,QAASC,EACX,EADWA,KAAMC,EACjB,EADiBA,WAAYC,EAC7B,EAD6BA,UAAWC,EACxC,EADwCA,MAGhDV,QAAQC,IAAI,UAAWK,EAAS,OAAQC,GAExC,IAeMI,EAfYC,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1DC,cAAe,CACbC,QAAS,cACTC,oBAAoB,UAAD,OAAYX,EAAZ,aAAwBG,EAAYC,EAApC,mBACnBQ,iBAAiB,UAAD,OAAYX,EAAZ,aAAqBC,EAAaE,EAAlC,oBAElBL,SAAU,CACRc,gBAAiB,WACjBC,UAAU,SAAD,OAAWV,EAAX,KACT,UAAW,CACTW,OAAQ,gBAKEC,GAOhB,OACM,uBAAKC,UAAWZ,EAAQI,eALvBV,EACEmB,WAAezC,IAAIsB,GAAU,SAACoB,GAAD,OAAW,uBAAKF,UAAWZ,EAAQN,UAAWoB,MAD5D,OCFXC,MAtBf,YAEW,IADTC,EACQ,EADRA,MAAOC,EACC,EADDA,MAAOC,EACN,EADMA,KAAMC,EACZ,EADYA,KAAMtD,EAClB,EADkBA,MAAOC,EACzB,EADyBA,OAc3BkC,EAXYC,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1Df,KAAM,CACJgC,gBAAgB,OAAD,OAASJ,EAAT,KACfK,gBAAgB,GAAD,OAAKJ,GACpBK,mBAAmB,IAAD,OAAMJ,EAAN,eAAiBC,EAAjB,MAClBtD,QACAC,SACAyD,eAAgB,iBAIJZ,GAEhB,OACE,uBAAKC,UAAWZ,EAAQZ,Q,kCC5BrB,SAASoC,EAAmBC,EAAoB3B,GACrD,OAAO4B,KAAKC,MAAMF,EAAa3B,GAOjC,SAAS8B,EAAQ/B,EAAoBgC,EAAqBlD,GACxD,OAAO+C,KAAKC,MAAMhD,EAAQkD,GAAehC,EAG3C,SAASiC,EAAQhC,EAAmB+B,EAAqBlD,GACvD,OAAQA,EAAQkD,EAAe/B,EAUjC,SAASiC,EAAapD,EAAeqC,EAAea,EAAqBG,EAAqBnC,EAAoBC,GAG9G,OAAO,aACLkB,MAAOA,GAXb,SAAgBnB,EAAoBC,EAAmB+B,EAAqBlD,GAC1E,MAAO,CACLwC,KAAMS,EAAQ/B,EAAYgC,EAAalD,GACvCuC,KAAMY,EAAQhC,EAAW+B,EAAalD,IASjCsD,CAAOpC,EAAYC,EAAW+B,EAAalD,GAFhD,CAGEd,MAAOiC,EACPhC,OAAQ+B,IAWCqC,MAPf,SAAoBlB,EAAgBa,EAAqBG,EAAqBlC,EAAmBD,EAAoBsC,GACnH,OAAO,IAAInE,MAAMmE,GAAOlE,KAAK,GAAGG,KAAI,SAACgE,EAAWzD,GAC5C,OAAOoD,EAAapD,EAAOqC,EAAOa,EAAaG,EAAanC,EAAYC,OCpBxEuC,EAAmB,CACrBzE,KAAM,OACNoD,MAAOsB,IACPb,WAAY,GACZO,YAAa,GACblC,UAAW,EACXD,WAAY,EACZsC,MAAO,GACPN,YAAa,EACbU,eAAgB,EAChBC,QAAS,IAGbH,EAAQR,YAAcL,EAAmBa,EAAQZ,WAAYY,EAAQvC,WACrEuC,EAAQE,eAAiBf,EAAmBa,EAAQL,YAAaK,EAAQxC,YACzEwC,EAAQG,QAAUN,EAAWG,EAAQrB,MAAOqB,EAAQR,YAAaQ,EAAQL,YAAaK,EAAQvC,UAAWuC,EAAQxC,WAAYwC,EAAQF,OAErI,IAAMM,EAAgB,CAClB7E,KAAM,OACNoD,MAAO0B,IACPjB,WAAY,GACZO,YAAa,GACblC,UAAW,EACXD,WAAY,EACZsC,MAAO,GACPN,YAAa,EACbU,eAAgB,EAChBC,QAAS,IAGbC,EAAKZ,YAAcL,EAAmBiB,EAAKhB,WAAYgB,EAAK3C,WAC5D2C,EAAKF,eAAiBf,EAAmBiB,EAAKT,YAAaS,EAAK5C,YAChE4C,EAAKD,QAAUN,EAAWO,EAAKzB,MAAOqB,EAAQR,YAAcY,EAAKT,YAAaS,EAAK3C,UAAW2C,EAAK5C,WAAY4C,EAAKN,OAEpH,IAOeQ,EAPE,CACbN,UACAI,QCIWG,MAlDf,WACE,IAAMC,EAAWC,cACXC,EAASC,aAAY,SAAC1E,GAAD,OAAsBA,EAAMyE,UACjDE,EAAQD,aAAY,SAAC1E,GAAD,OAAsBA,EAAM4E,MAAMD,SACtDE,EAAcH,aAAY,SAAC1E,GAAD,OAAsBA,EAAM8E,WACtDA,EAAUT,EAASQ,GACnBX,EAAUY,EAAQZ,QAExB,SAASnE,EAAMM,GACbkE,EL4DG,SAAmBlE,EAAeS,GACvC,MAAO,CACLN,KAAM,WACNC,KAAM,CACJI,OAAQ,CACNR,QAAOS,UKjEFiE,CAAU1E,EAAOsE,IA2B5B,OAA6B,IAAzBF,EAAOpF,QAAQE,MAAoB,KAGjC,gBAAC,EAAD,CACE8B,QAASoD,EAAOpF,QAAQE,MACxB+B,KAAMmD,EAAOpF,QAAQG,OACrB+B,WAAYuD,EAAQvD,WACpBC,UAAWsD,EAAQtD,UACnBC,MAAO,GAAGqD,EAAQtD,WApBjBiD,EAAOhF,QAAQgF,EAAO7E,SAASE,KAAI,SAACgB,EAAcT,GAAf,OAClC,uBACE2E,IAAK3E,EACL4E,YAAa,kBAAMlF,EAAMM,IACzB6E,aAAc,SAACC,GAAD,OAAuC,IAA5BA,EAAMC,YAAYC,OAAetF,EAAMM,KAE/DS,GAAQ,GAAK,gBAAC,EAASoD,EAAQpD,KACrB,IAAVA,GAAe,gBAAC,EAlB7B,SAAkBT,EAAegB,GAG/B,MAAO,CACLsB,OAHiBtC,EAAQgB,EAAW+B,KAAKC,MAAMhD,EAAQgB,IAGpC,IAAM,EAAI,OAAS,QACtC9B,MAAOuF,EAAQtD,UACfhC,OAAQsF,EAAQvD,YAYkB+D,CAASjF,EAAOoE,EAAOpF,QAAQE,c,kBC5BjEgG,EAA2B,CAC/BZ,MAAO,GAGT,SAASa,EAAQxF,EAAmB2E,GAElC,OADc,eAAQ3E,EAAR,CAAe2E,UAaxB,SAASc,EAASd,GACvB,MAAO,CACLnE,KAAM,YACNC,KAAM,CAAEkE,UAIGe,MAhBf,WAA0F,IAApE1F,EAAmE,uDAA/CuF,EAAc3E,EAAiC,uCACvF,OAAQA,EAAOJ,MACb,IAAK,YACH,OAAOgF,EAAQxF,EAAOY,EAAOH,KAAKkE,OACpC,QACE,OAAO3E,I,yBCHE2F,MAdf,WACI,IAAMpB,EAAWC,cAEjB,OACI,6BACI,yBAAKoB,QAAS,kBAAMrB,EAASkB,GAAU,MACnC,kBAACI,EAAA,EAAD,KACI,kBAAC,OAAD,CAAMC,KAAMC,U,iBCGjBJ,MAZf,WACI,IAAMpB,EAAWC,cAEjB,OACI,yBAAKoB,QAAS,kBAAMrB,ER+EnB,CACL/D,KAAM,WQ/EE,kBAACqF,EAAA,EAAD,KACI,kBAAC,IAAD,S,iBCIDF,MAVf,WACI,IAAMpB,EAAWC,cAEjB,OACI,kBAACqB,EAAA,EAAD,CAAYD,QAAS,kBAAMrB,ETqF1B,CACL/D,KAAM,WSrFE,kBAAC,IAAD,Q,iBCTNwF,EAAM,wBAmBL,SAASC,EAAQnG,EAAcoG,GACpCnF,QAAQC,IAAIkF,GAEM,UAAhB,OAA2BA,GAG7B,OAAIpG,EAAIqG,GACCC,IAAMC,IAAN,UAAaL,EAAb,qBAA6BlG,EAAIqG,IAAMrG,EAAK,CAAEwG,QAAS,CAAEC,cAAc,UAAD,OAAYL,MACxFM,MAAK,SAAUC,GAEd,OADA1F,QAAQC,IAAI,OAAQyF,GACbA,EAAShG,QAIb2F,IAAMM,KAAN,UAAcV,EAAd,aAA8BlG,EAAK,CAAEwG,QAAS,CAAEC,cAAc,UAAD,OAAYL,MAC7EM,MAAK,SAAUC,GAEd,OADA1F,QAAQC,IAAI,OAAQyF,GACbA,EAAShG,QAIf,SAASkG,EAAUR,GACxB,OAAOC,IAAMQ,OAAN,UAAgBZ,EAAhB,qBAAgCG,IACpCK,MAAK,SAAUC,GAEd,OADA1F,QAAQC,IAAI,UAAWyF,GAChBA,EAAShG,QAIP,QAAEoG,OArCV,WACH,OAAOT,IAAMU,IAAN,UAAad,EAAb,cACJQ,MAAK,SAAUC,GAEd,OADA1F,QAAQC,IAAI,OAAQyF,GACbA,EAAShG,SAiCCwF,UAASU,a,oBCyBnBI,OAhEf,WAAgE,IAAD,QAA1C/G,EAA0C,uDAAvB,GAAIY,EAAmB,uCAC7D,OAAQA,EAAOJ,MACb,IAAK,WACH,OAAO,UAAAI,EAAOH,YAAP,eAAauG,MAAOpG,EAAOH,KAAKuG,KAAOhH,EAChD,IAAK,aACH,IAAMiH,EAAY,UAAGrG,EAAOH,YAAV,iBAAG,EAAaX,WAAhB,aAAG,EAAkBqG,GACvC,OAAOc,EAAejH,EAAMkH,QAAO,SAAApH,GAAG,OAAIA,EAAIqG,KAAOc,KAAgBjH,EACvE,IAAK,WACH,IAAMmH,EAAQ,UAAGvG,EAAOH,YAAV,aAAG,EAAaX,IAC9B,GAAIqH,EAAU,CACZ,IAAM9G,EAAQL,EAAMoH,QAAO,SAACC,EAAWvH,EAAKwH,GAAjB,OAAuBxH,EAAIqG,KAAOgB,EAAShB,GAAKmB,EAAID,KAAY,GAC3F,OAAIhH,GAAS,EACJL,EAAMF,KAAI,SAACA,EAAKwH,GAAN,OAAYA,IAAMjH,EAAQ8G,EAAWrH,KAE/CE,EAAMuH,OAAOJ,GAGxB,OAAOnH,EACT,QACE,OAAOA,ICEEwH,OAvBf,WACE,IAAMjD,EAAWC,cACXnF,EAAUqF,aAAY,SAAC1E,GAAD,OAAsBA,EAAMyE,UAClDyB,EAAQxB,aAAY,SAAC1E,GAAD,OAAsBA,EAAMyH,KAAKvB,SACrDrB,EAAcH,aAAY,SAAC1E,GAAD,OAAsBA,EAAM8E,WACtDhF,EAAY,eAAQT,EAAQA,QAAhB,CAAyBA,QAASA,EAAQI,QAAQJ,EAAQO,SAAUkF,QAASD,IAW/F,OACE,kBAACgB,EAAA,EAAD,CAAYD,QAAS,WATrBM,GAASD,EAAQnG,EAAKoG,GACnBM,MAAK,SAAAW,GACJpG,QAAQC,IAAI,YAAamG,GACzB5C,EAAS7D,EAAUyG,IACnB5C,ED6CD,SAAmBzE,GACxB,MAAO,CACLU,KAAM,WACNC,KAAM,CACJX,QCjDW4H,CAAUP,QAKYQ,UAAWzB,GAC5C,kBAAC,KAAD,Q,6BCZS0B,OAVf,WACE,IAAMnI,EAAUoI,eAEhB,OACE,kBAAChC,EAAA,EAAD,CAAYD,QAAS,kBAAMnG,EAAQqI,KAAK,WACtC,kBAAC,KAAD,Q,mBCAAzF,GAAYV,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1DkG,OAAQ,CACN9H,SAAU,WACV+H,IAAK,MACLC,KAAM,MACN9F,UAAW,wBACXD,gBAAiB,eAmDNgG,OA1Cf,WACE,IAAMxG,EAAUW,KACVkC,EAAWC,cACXK,EAAcH,aAAY,SAAC1E,GAAD,OAAsBA,EAAM8E,WACtDA,EAAUT,EAASQ,GACnBX,EAAUY,EAAQZ,QAClBS,EAAQD,aAAY,SAAC1E,GAAD,OAAsBA,EAAM4E,MAAMD,SAN3C,EAQOpC,YAAe,GARtB,oBAQV4F,EARU,KAQJC,EARI,KAkBjB,OACE,2BACE,uBAAKjC,GAAI,gBAAiBP,QAAS,kBAAMwC,GAAQ,KAC/C,gBAACvC,EAAA,EAAD,KACE,gBAAC,EAAD,CAAMxE,QAAS,EAAGC,KAAM,EAAGC,WAAYuD,EAAQvD,WAAYC,UAAWsD,EAAQtD,UAAWC,MAAO,GAAGqD,EAAQtD,WACxGmD,GAAS,GACP,gBAAC,EAAST,EAAQS,OAK3B,uBAAKiB,QAAS,kBAAMwC,GAAQ,KAC1B,gBAACC,GAAA,EAAD,CAAOF,KAAMA,EAAMG,QAAS,kBAAMF,GAAQ,KACxC,uBAAK9F,UAAWZ,EAAQqG,QACtB,gBAAC,EAAD,CAAM1G,QAASyD,EAAQvB,YAAajC,KAAMwD,EAAQb,eAAgB1C,WAAYuD,EAAQvD,WAAYC,UAAWsD,EAAQtD,UAAWC,MAAO,GAAKqD,EAAQtD,WArBrJ9B,MAAMoF,EAAQjB,OAAOlE,KAAK,GAAGG,KAAI,SAACgE,EAAWzD,GAAZ,OACtC,uBAAK2E,IAAK3E,EAAOuF,QAAS,kBAAMrB,EAASkB,EAASpF,MAChD,gBAAC,EAAS6D,EAAQ7D,c,oBC5BpBuE,GAAQ,CACZ,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,EAAD,MACA,kBAAC,EAAD,MACA,kBAAC,EAAD,MACA,kBAAC,GAAD,OAkBa2D,OAff,WACE,OACM,kBAACC,GAAA,EAAD,CAAMrC,GAAG,SACNvB,GAAM9E,KAAI,SAAC2I,EAAoBpI,GAC5B,OACE,kBAACqI,GAAA,EAAD,CAAU1D,IAAK3E,GACZoI,QCjBbpG,GAAYV,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1D8G,KAAM,CACJ5G,QAAS,QAEX6G,OAAQ,CACNC,OAAQjH,EAAMiH,OAAOC,OAAS,GAEhCA,OAAQ,CAENC,WAAY,GAEdC,MAAO,CACLC,SAAU,GAEZR,KAAM,CACJS,YAAa,OAEfC,QAAS,CACPC,OAAQ,QAEVC,cAAezH,EAAM0H,OAAOC,aAiCfC,OAxBf,YAAuC,IAApBpI,EAAmB,EAAnBA,SACXuD,EAAQD,aAAY,SAAC1E,GAAD,OAAsBA,EAAM4E,MAAMD,SAC5D5D,QAAQC,IAAI,QAAS2D,GACrB,IAAMjD,EAAUW,KAEhB,OACM,yBAAKC,UAAWZ,EAAQiH,MAEpB,yBAAKrG,UAAWZ,EAAQyH,SAEpB,kBAACM,EAAA,EAAD,CAAQC,QAAQ,aACd,yBAAKpH,UAAWZ,EAAQ2H,gBACxB,kBAAC,GAAD,OAGF,yBAAK/G,UAAWZ,EAAQyH,SACrB/H,M,+EC1CbiB,GAAYV,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1D/B,IAAK,CACHsJ,OAAQ,OAEVO,aAAc,CACZ5H,QAAS,OACTvC,OAAQ,OACRoK,SAAU,SACVC,WAAY,SACZC,eAAgB,SAChBV,OAAQ,cA8DGW,OAtDf,YAAkC,IAAfjK,EAAc,EAAdA,IACXL,EAAUoI,eACV/C,EAAUT,EAASvE,EAAIgF,SACvBZ,EAAUY,EAAQZ,QAClBK,EAAWC,cACX9C,EAAUW,KAoBhB,OACE,kBAAC2H,GAAA,EAAD,CAAM1H,UAAWZ,EAAQ5B,IAAKkF,IAAKlF,EAAIR,MACrC,kBAAC2K,GAAA,EAAD,CAAgBrE,QAAS,kBAN3BrB,EAAShE,EAAKT,SACdL,EAAQqI,KAAK,OAMT,kBAACoC,GAAA,EAAD,KACE,yBAAK5H,UAAWZ,EAAQiI,cACtB,kBAAC,EAAD,CAAMrI,KAAMxB,EAAIN,OAAQ6B,QAASvB,EAAIP,MAAOgC,WAAYuD,EAAQvD,WAAYC,UAAWsD,EAAQtD,UAAWC,MAAO,EAAEqD,EAAQtD,WAvBrI,SAAkB1B,GAChB,OAAOA,EAAIT,QAAQS,KAAI,SAACgB,EAAcT,GAAf,OACrB,yBAAK2E,IAAK3E,GACPS,GAAQ,GAAK,kBAAC,EAASoD,EAAQpD,QAqBzBqJ,CAASrK,MAIhB,kBAACsK,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAYX,QAAQ,MACjB5J,EAAIR,QAKX,kBAACgL,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAQC,UAAWC,KAAMC,GAAI,IAAK9E,QAAS,kBAAMrB,EAAShE,EAAKT,MAA/D,QAGA,kBAACyK,GAAA,EAAD,CAAQ3E,QAAS,kBA/BvB,SAAmB9F,GACjByE,ENYG,SAAmBzE,GACxB,MAAO,CACLU,KAAM,aACNC,KAAM,CACJX,QMhBO6K,CAAO7K,IAChBA,EAAIqG,IAAMQ,EAAU7G,EAAIqG,IA6BGyE,CAAU9K,KAAjC,aClEFuC,GAAYV,aAAW,kBAAME,YAAa,CAC5C/B,IAAK,CACHsJ,OAAQ,OAEVyB,QAAS,CACP9I,QAAS,aA2BA+I,OAvBf,WACE,IAAMvG,EAAWC,cAEjBuG,qBAAU,WACRxG,GPaK,SAAAA,GACLyG,GAAYnE,SACTL,MAAK,SAAAQ,GACJzC,EAAS,CACP/D,KAAM,WACNC,KAAM,CACJuG,kBOlBP,CAACzC,IAEJ,IAAMyC,EAAOtC,aAAY,SAAC1E,GAAD,OAAsBA,EAAMgH,QAC/CtF,EAAUW,KAQhB,OACE,uBAAKC,UAAWZ,EAAQmJ,SALtB7D,EAAKlH,KAAI,SAACA,GAAD,OAAkB,gBAAC,GAAD,CAASkF,IAAKlF,EAAIqG,GAAIrG,IAAKA,S,oGCtBtDuC,GAAYV,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1DoJ,KAAM,CACJlJ,QAAS,OACTmJ,QAAS,MACTC,WAAY,QACZC,QAAS,YAgEEC,OA5Df,WACE,IAAMhM,EAAUqF,aAAY,SAAC1E,GAAD,OAAsBA,EAAMyE,OAAOpF,WACzDwF,EAAcH,aAAY,SAAC1E,GAAD,OAAsBA,EAAM8E,WACtDP,EAAWC,cACX9C,EAAUW,KAJE,EAMMiJ,mBAASjM,EAAQC,MANvB,oBAMXA,EANW,KAMLiM,EANK,OAOQD,mBAASjM,EAAQE,OAPzB,oBAOXA,EAPW,KAOJiM,EAPI,OAQUF,mBAASjM,EAAQG,QAR3B,oBAQXA,EARW,KAQHiM,EARG,OASYH,mBAASzG,GATrB,oBASXC,EATW,KASF4G,EATE,KA2ClB,OACE,yBAAKpJ,UAAWZ,EAAQuJ,MACtB,kBAACU,GAAA,EAAD,CAAWC,MAAM,OAAOlC,QAAQ,WAAWmC,aAAcvM,EAAMwM,SAAU,SAAC3G,GAAD,OAAWoG,EAAQpG,EAAMtE,OAAOkL,UACzG,kBAACJ,GAAA,EAAD,CAAWC,MAAM,QAAQpL,KAAK,SAASkJ,QAAQ,WAAWmC,aAActM,EAAOuM,SAAU,SAAC3G,GAAD,OAAWqG,EAASQ,OAAOC,SAAS9G,EAAMtE,OAAOkL,WAC1I,kBAACJ,GAAA,EAAD,CAAWC,MAAM,SAASpL,KAAK,SAASkJ,QAAQ,WAAWmC,aAAcrM,EAAQsM,SAAU,SAAC3G,GAAD,OAAWsG,EAAUO,OAAOC,SAAS9G,EAAMtE,OAAOkL,WAC7I,kBAACG,GAAA,EAAD,CAAaxC,QAAQ,YACnB,kBAACyC,GAAA,EAAD,CAAYhG,GAAG,wBAAf,YACA,kBAACiG,GAAA,EAAD,CAAQC,QAAQ,uBAAuBT,MAAM,UAAUG,MAAOjH,EAAS4E,QAAQ,WAAWoC,SAAU,SAAC3G,GAAD,OAjCrF,SAACA,GACpBpE,QAAQC,IAAImE,EAAMtE,OAAOkL,OACzBL,EAAWvG,EAAMtE,OAAOkL,OA+B2FO,CAAanH,KAtCzHoH,OAAOC,KAAKnI,GAAUvE,KAAI,SAACgF,GAChC,OAAO,kBAAC2H,GAAA,EAAD,CAAUzH,IAAKF,EAASiH,MAAOjH,GAAUA,QAyChD,kBAACyF,GAAA,EAAD,CAAQ/J,KAAK,SAASkJ,QAAQ,YAAY/G,MAAM,UAAUiD,QAAS,SAACT,GAAD,OAhCpD,SAACA,GAClBA,EAAMuH,iBACNnI,EAAS7D,EAAU,eAAKrB,EAAN,CAAeC,OAAMC,QAAOC,SAAQsF,cA8B0B6H,CAAWxH,KAAzF,iBACA,kBAACoF,GAAA,EAAD,CAAQ/J,KAAK,SAASkJ,QAAQ,WAAW9D,QAAS,SAACT,GAAD,OA5B9B,SAACA,GACvBA,EAAMuH,iBAEN,IAAMvM,EAAkB,CACtB2E,UACAxF,KAAM,UACNC,QACAC,SACAH,QAAS,IAAIK,MAAMH,EAAQC,GAAQG,MAAM,IAG3CoB,QAAQC,IAAI,mBAAoBb,GAChCoE,EAAShE,EAAKJ,IACdoL,EAAQ,WAeuDqB,CAAgBzH,KAA7E,gBClEA9C,GAAYV,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1DkG,OAAQ,CACN9H,SAAU,WACV+H,IAAK,MACLC,KAAM,MACN9F,UAAW,wBACXD,gBAAiB,eAuBN2K,OAnBf,WAAiB,IAAD,EACUvB,oBAAS,GADnB,oBACPnD,EADO,KACDC,EADC,KAER1G,EAAUW,KAEhB,OACE,6BACE,kBAACwD,EAAA,EAAD,CAAYD,QAAS,kBAAMwC,GAAQ,KACjC,kBAAC,KAAD,OAGF,kBAACC,GAAA,EAAD,CAAOF,KAAMA,EAAMG,QAAS,kBAAMF,GAAQ,KACxC,yBAAK9F,UAAWZ,EAAQqG,QACtB,kBAAC,GAAD,U,wCCeK+E,OA5Bf,WAA4D,IAAvC9M,EAAsC,uDAAxB,GAAIY,EAAoB,uCACvD,OAAQA,EAAOJ,MACX,IAAM,QACF,OAAOI,EAAOH,KAClB,IAAM,SACF,MAAO,GACX,QACE,OAAOT,ICIF+M,OArBf,WACE,IAAMxI,EAAWC,cAEXwI,EAAiB,SAACvG,GDkBnB,IAAeN,EAAY7G,EAAc4G,GCjB5CnF,QAAQC,IAAIyF,GACRA,EAASwG,QACb1I,GDekB4B,ECfHM,EAASyG,SDeM5N,ECfImH,EAAS0G,WAAW7N,KDeV4G,ECfgBO,EAAS2G,YDgB9D,CACH5M,KAAM,QACNC,KAAM,CACFnB,OACA6G,KACAD,aClBV,OACI,kBAAC,KAAD,CACEmH,SAAS,2EACTC,WAAW,QACXC,UAAWP,EACXQ,UAAWR,EACXS,aAAc,qBACdC,YAAY,KCGLC,OAlBf,WACE,IAAMpJ,EAAWC,cAOjB,OACE,kBAAC,gBAAD,CACE6I,SAAS,2EACTC,WAAW,SACXM,gBATiB,WACnBrJ,EF4BO,CACH/D,KAAM,WE5BVO,QAAQC,IAAI,kBCEVqB,GAAYV,aAAW,SAACC,GAAD,OAAkBC,YAAa,CAC1D8G,KAAM,CACJ5G,QAAS,QAEX6G,OAAQ,CACNC,OAAQjH,EAAMiH,OAAOC,OAAS,GAEhCE,MAAO,CACLC,SAAU,EACV,UAAW,CACT7G,OAAQ,YAGZ+G,QAAS,CACPC,OAAQ,QAEVC,cAAezH,EAAM0H,OAAOC,aAkFfsE,OAzEf,YAAsC,IAApBzM,EAAmB,EAAnBA,SACV0M,EAAUpJ,aAAY,SAAC1E,GAAD,OAAsBA,EAAMyE,OAAOpF,QAAQC,QACjEmI,EAAO/C,aAAY,SAAC1E,GAAD,OAAsBA,EAAMyH,QAC/ChI,EAAUoI,eACVnG,EAAUW,KAehB,OACE,yBAAKC,UAAWZ,EAAQiH,MAEtB,kBAACoF,GAAA,EAAD,CAAQpL,MAAM,UAAU1C,SAAS,WAAWqC,UAAWZ,EAAQkH,QAC7D,kBAACoF,GAAA,EAAD,KACE,kBAAC,KAAD,CACEC,WAAS,EACTC,UAAU,MACVC,QAAQ,gBACRtE,WAAW,UAGX,kBAAC,KAAD,CAASuE,MAAI,EAACC,GAAI,GAChB,kBAAChE,GAAA,EAAD,CAAYX,QAAQ,KAAKpH,UAAWZ,EAAQsH,MAAOpD,QAAS,kBAAMnG,EAAQqI,KAAK,OAA/E,gBAKF,kBAAC,KAAD,CAASsG,MAAI,GAET,kBAAC,KAAD,KACE,kBAAC,KAAD,CAAOE,OAAK,EAACC,KAAK,WAElB,kBAAC,KAAD,CAAOD,OAAK,EAACC,KAAK,SAChB,kBAAC1I,EAAA,EAAD,CAAYD,QAAS,kBAAMnG,EAAQqI,KAAK,OACtC,kBAAC,KAAD,QAIJ,kBAAC,KAAD,CAAOwG,OAAK,EAACC,KAAK,KAxC9B,kBAAC,KAAD,CAASN,WAAS,EAACpE,WAAW,UAC5B,kBAAC,KAAD,CAASuE,MAAI,GACX,kBAAC,GAAD,OAEF,kBAAC,KAAD,CAASA,MAAI,GACX,kBAAC/D,GAAA,EAAD,CAAYX,QAAQ,KAAK3H,QAAQ,SAASyM,MAAM,WAAWV,QA0CzD,kBAAC,KAAD,CAASM,MAAI,EAACC,GAAI,EAAGI,MAAO,CAAEC,UAAW,WACrCjH,EAAKvB,OAAS,kBAAC,GAAD,MACfuB,EAAKvB,OAAS,kBAAC,GAAD,UAOvB,yBAAK5D,UAAWZ,EAAQyH,SACtB,yBAAK7G,UAAWZ,EAAQ2H,gBACvBjI,KC9EMuN,OAlBf,WACE,OACE,gBAAC,KAAD,KACE,gBAAC,GAAD,KACE,gBAAC,KAAD,KACE,gBAAC,KAAD,CAAOL,OAAK,EAACC,KAAK,UAAS,gBAAC,GAAD,OAC3B,gBAAC,KAAD,CAAOD,OAAK,EAACC,KAAK,KAChB,gBAAC,GAAD,KACE,gBAAC,EAAD,QAGJ,gBAAC,KAAD,CAAOA,KAAK,SAAQ,gBAAC,GAAD,W,kBCYfK,OApBf,WAA2E,IAAD,EAAlD5O,EAAkD,uDAAlC,UAAWY,EAAuB,uCACxE,OAAQA,EAAOJ,MACb,IAAK,cACH,OAAOI,EAAOH,KAAKqE,SAAW9E,EAChC,IAAK,WACL,IAAK,aAEH,OADAe,QAAQC,IAAI,UAAWJ,EAAOH,OACvB,UAAAG,EAAOH,YAAP,eAAapB,SAAUuB,EAAOH,KAAKpB,QAAQyF,QAAU9E,EAC9D,QACE,OAAOA,I,SCFP6O,GAAUC,2BAAgB,CAC9BrH,KAAMqF,GACNhI,QAAS8J,GACTnK,OAAQ9D,EACRiE,MAAOc,EACPsB,KAAMD,KAGFgI,GAAQC,uBACZH,GACAI,+BACEC,2BAAgBC,QAEpBpO,QAAQC,IAAI,QAAS+N,GAAMK,YAEZL,UC3BTM,GAAS,kBAAMC,IAASD,OAC5B,gBAAC,IAAD,CAAUN,MAAOA,IACb,gBAAC,GAAD,OAEJQ,SAASC,eAAe,UAG1BH,KACAN,GAAMU,UAAUJ,K,iBCdhBK,EAAOC,QAAU,89F,iBCAjBD,EAAOC,QAAU,m7B","file":"static/js/main.a5d04a26.chunk.js","sourcesContent":["import { TileMap } from '../services/mapsService';\r\n\r\nexport interface CanvasState {\r\n  tileMap: TileMap,\r\n  history: number[][],\r\n  current: number\r\n}\r\n\r\ninterface CanvasAction {\r\n  type: string,\r\n  data?: {\r\n    target: {\r\n      index: number,\r\n      tile: number\r\n    }\r\n    tileMap?: TileMap,\r\n    name?: string\r\n  }\r\n}\r\n\r\nconst nullState = {\r\n  tileMap: {\r\n    name: \"New Map\",\r\n    width: 16,\r\n    height: 16,\r\n    tileMap: []\r\n  },\r\n  history: [new Array(16*16).fill(-1)],\r\n  current: 0\r\n}\r\n\r\nconst newState = (map: TileMap) => {\r\n  return {\r\n    tileMap: map,\r\n    history: [map.tileMap],\r\n    current: 0,\r\n  };\r\n};\r\n\r\nfunction paint(state: CanvasState, position: number, newTile: number): CanvasState {\r\n  const currentMap = state.history[state.current];\r\n  const newMap = currentMap.map((oldTile, index) => (index === position ? newTile : oldTile));\r\n  const history = [...state.history.slice(0, state.current + 1), newMap];\r\n  const current = state.current + 1;\r\n  return { ...state, history, current };\r\n};\r\n\r\nfunction canvasReducer(state: CanvasState = nullState as any, action: CanvasAction): CanvasState {\r\n  switch (action.type) {\r\n    case 'LOAD_MAP':\r\n      return action.data?.tileMap ? newState(action.data.tileMap) : state;\r\n    case 'SET_TILE':\r\n      return action.data?.target ? paint(state, action.data.target.index, action.data.target.tile) : state;\r\n    case 'UNDO':\r\n      if (state.current === 0) return state;\r\n      console.log('didnt undo');\r\n      return { ...state, current: state.current - 1 };\r\n    case 'REDO':\r\n      if (state.current === state.history.length - 1) return state;\r\n      return { ...state, current: state.current + 1 };\r\n    case 'UPDATE_MAP':\r\n      const updatedTileMap = action.data?.tileMap;\r\n      if (!updatedTileMap) return state;\r\n\r\n      console.log('updating tilemap', updatedTileMap);\r\n      let history = state.history;\r\n      let current = state.current;\r\n      if (updatedTileMap.width !== state.tileMap.width || updatedTileMap.height !== state.tileMap.height) {\r\n        history = [new Array(updatedTileMap.width * updatedTileMap.height).fill(-1)];\r\n        current = 0;\r\n      }\r\n      return { ...state, tileMap: updatedTileMap, history, current };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport function paintTile(index: number, tile: number) {\r\n  return {\r\n    type: 'SET_TILE',\r\n    data: {\r\n      target: {\r\n        index, tile\r\n      }\r\n    },\r\n  };\r\n};\r\n\r\nexport function undo() {\r\n  return {\r\n    type: 'UNDO',\r\n  };\r\n};\r\n\r\nexport function redo() {\r\n  return {\r\n    type: 'REDO',\r\n  };\r\n};\r\n\r\nexport function load(tileMap: TileMap) {\r\n  return {\r\n    type: 'LOAD_MAP',\r\n    data: {\r\n      tileMap\r\n    }\r\n  }\r\n};\r\n\r\nexport function updateMap(map: TileMap) {\r\n  return {\r\n    type: 'UPDATE_MAP',\r\n    data: {\r\n      tileMap: map\r\n    }\r\n  }\r\n}\r\n\r\nexport default canvasReducer;\r\n","import * as React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nexport interface Props {\r\n  rows: number,\r\n  columns: number,\r\n  tileHeight: number,\r\n  tileWidth: number,\r\n  scale: number,\r\n  children: React.ReactNode\r\n}\r\n\r\nfunction Grid({\r\n  children, columns, rows, tileHeight, tileWidth, scale,\r\n}: Props) {\r\n  \r\n  console.log('columns', columns, 'rows', rows)\r\n\r\n  const useStyles = makeStyles((theme: Theme) => createStyles({\r\n    gridContainer: {\r\n      display: 'inline-grid',\r\n      gridTemplateColumns: `repeat(${columns}, ${tileWidth * scale}px [col-start])`,\r\n      gridTemplateRows: `repeat(${rows}, ${tileHeight * scale}px [row-start])`,\r\n    },\r\n    children: {\r\n      transformOrigin: 'top left',\r\n      transform: `scale(${scale})`,\r\n      '&:hover': { //TODO: It's not this component's responsibility to provide this behaviour\r\n        cursor: 'pointer',\r\n      },\r\n    },\r\n  }));\r\n\r\n  const classes = useStyles();\r\n\r\n  function styledChildren(): any {\r\n    if (!children) return null;\r\n    return React.Children.map(children, (child) => <div className={classes.children}>{child}</div>);\r\n  }\r\n\r\n  return (\r\n        <div className={classes.gridContainer}>\r\n            {styledChildren()}\r\n        </div>\r\n  );\r\n}\r\n\r\nexport default Grid;\r\n","import * as React from 'react';\r\nimport { makeStyles, createStyles, Theme } from '@material-ui/core';\r\n\r\nexport interface Props {\r\n  image?: string;\r\n  color?: string;\r\n  posX?: number;\r\n  posY?: number;\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nfunction Tile({\r\n  image, color, posX, posY, width, height\r\n}: Props) {\r\n\r\n  const useStyles = makeStyles((theme: Theme) => createStyles({\r\n    tile: {\r\n      backgroundImage: `url(${image})`,\r\n      backgroundColor: `${color}`,\r\n      backgroundPosition: `-${posX}px -${posY}px`,\r\n      width,\r\n      height,\r\n      imageRendering: 'pixelated',\r\n    }\r\n  }));\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div className={classes.tile} />\r\n  );\r\n}\r\n\r\nexport default Tile;\r\n","import { Props as TileProps } from \"../components/Tile\";\r\n\r\nexport function computeTilesPerRow(imageWidth: number, tileWidth: number): number {\r\n  return Math.floor(imageWidth / tileWidth);\r\n};\r\n\r\nexport function computeTilesPerColumn(imageHeight: number, tileHeight: number) {\r\n  return Math.floor(imageHeight / tileHeight);\r\n};\r\n\r\nfunction getPosY(tileHeight: number, tilesPerRow: number, index: number) {\r\n  return Math.floor(index / tilesPerRow) * tileHeight;\r\n};\r\n\r\nfunction getPosX(tileWidth: number, tilesPerRow: number, index: number) {\r\n  return (index % tilesPerRow) * tileWidth;\r\n};\r\n\r\nfunction getPos(tileHeight: number, tileWidth: number, tilesPerRow: number, index: number) {\r\n  return {\r\n    posY: getPosY(tileHeight, tilesPerRow, index),\r\n    posX: getPosX(tileWidth, tilesPerRow, index)\r\n  };\r\n};\r\n\r\nfunction getTileProps(index: number, image: string, tilesPerRow: number, imageHeight: number, tileHeight: number, tileWidth: number): TileProps {\r\n    //console.log('tile', index, 'posX', posX, 'posY', posY); \r\n\r\n    return {\r\n      image: image,\r\n      ...getPos(tileHeight, tileWidth, tilesPerRow, index),\r\n      width: tileWidth,\r\n      height: tileHeight\r\n    }\r\n};\r\n\r\nfunction getMapping(image: string,  tilesPerRow: number, imageHeight: number, tileWidth: number, tileHeight: number, tiles: number): TileProps[] {\r\n  return new Array(tiles).fill(0).map((n: number, index: number) => {\r\n      return getTileProps(index, image, tilesPerRow, imageHeight, tileHeight, tileWidth);\r\n    }\r\n  )\r\n};\r\n\r\nexport default getMapping;","import cityImage from '../tileSets/revolution_tiles.png';\r\nimport caveImage from '../tileSets/bw_tiles.png';\r\nimport { Props as TileProps } from '../components/Tile';\r\nimport getMapping, { computeTilesPerRow } from '../utils/tileMapping';\r\n\r\nexport interface TileSet {\r\n    name: string,\r\n    image: string,\r\n    imageWidth: number,\r\n    imageHeight: number,\r\n    tileWidth: number,\r\n    tileHeight: number,\r\n    tiles: number,\r\n    tilesPerRow: number,\r\n    tilesPerColumn: number,\r\n    mapping: TileProps[]\r\n}\r\n\r\nconst Harbour: TileSet = {\r\n    name: 'City',\r\n    image: cityImage,\r\n    imageWidth: 64,\r\n    imageHeight: 80,\r\n    tileWidth: 8,\r\n    tileHeight: 8,\r\n    tiles: 78,\r\n    tilesPerRow: 0,\r\n    tilesPerColumn: 0,\r\n    mapping: []\r\n};\r\n\r\nHarbour.tilesPerRow = computeTilesPerRow(Harbour.imageWidth, Harbour.tileWidth);\r\nHarbour.tilesPerColumn = computeTilesPerRow(Harbour.imageHeight, Harbour.tileHeight);\r\nHarbour.mapping = getMapping(Harbour.image, Harbour.tilesPerRow, Harbour.imageHeight, Harbour.tileWidth, Harbour.tileHeight, Harbour.tiles);\r\n\r\nconst Cave: TileSet = {\r\n    name: 'Cave',\r\n    image: caveImage,\r\n    imageWidth: 64,\r\n    imageHeight: 56,\r\n    tileWidth: 8,\r\n    tileHeight: 8,\r\n    tiles: 50,\r\n    tilesPerRow: 0,\r\n    tilesPerColumn: 0,\r\n    mapping: []\r\n}\r\n\r\nCave.tilesPerRow = computeTilesPerRow(Cave.imageWidth, Cave.tileWidth);\r\nCave.tilesPerColumn = computeTilesPerRow(Cave.imageHeight, Cave.tileHeight);\r\nCave.mapping = getMapping(Cave.image, Harbour.tilesPerRow,  Cave.imageHeight, Cave.tileWidth, Cave.tileHeight, Cave.tiles);\r\n\r\nconst tileSets = {\r\n    Harbour,\r\n    Cave\r\n} as {\r\n    [key: string]: TileSet\r\n}\r\n\r\nexport default tileSets;\r\n","import * as React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { paintTile } from '../reducers/canvasReducer';\r\nimport Grid from './Grid';\r\nimport Tile from './Tile';\r\nimport { RootState } from '../store';\r\nimport tileSets from '../services/tileSets';\r\n\r\nfunction Canvas() {\r\n  const dispatch = useDispatch();\r\n  const canvas = useSelector((state: RootState) => state.canvas);\r\n  const brush = useSelector((state: RootState) => state.tools.brush);\r\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\r\n  const tileSet = tileSets[tileSetName];\r\n  const mapping = tileSet.mapping;\r\n\r\n  function paint(index: number) {\r\n    dispatch(paintTile(index, brush));\r\n    // console.log('painting', brush, 'on', index);\r\n  }\r\n\r\n  function getColor(index: number, columns: number) {\r\n    const tileValue = (index % columns) + Math.floor(index / columns);\r\n    //console.log('index', index, 'tileValue', tileValue);\r\n    return {\r\n      color: tileValue % 2 === 0 ? 'GREY' : 'WHITE',\r\n      width: tileSet.tileWidth,\r\n      height: tileSet.tileHeight\r\n    }\r\n  }\r\n\r\n  function parseTileArray() {\r\n    return canvas.history[canvas.current].map((tile: number, index: number) => (\r\n            <div\r\n              key={index}\r\n              onMouseDown={() => paint(index)}\r\n              onMouseEnter={(event) => event.nativeEvent.which === 1 && paint(index)}\r\n            >\r\n              {tile >= 0 && <Tile {...mapping[tile]} />}\r\n              {tile === -1 && <Tile {...getColor(index, canvas.tileMap.width)}/>}\r\n            </div>\r\n    ));\r\n  }\r\n\r\n  if (canvas.tileMap.width === 0) return null;\r\n\r\n  return (\r\n        <Grid\r\n          columns={canvas.tileMap.width}\r\n          rows={canvas.tileMap.height}\r\n          tileHeight={tileSet.tileHeight}\r\n          tileWidth={tileSet.tileWidth}\r\n          scale={32/tileSet.tileWidth} >\r\n            {parseTileArray()}\r\n        </Grid>\r\n  );\r\n}\r\n\r\nexport default Canvas;\r\n","export interface BrushState {\r\n  brush: number\r\n}\r\n\r\ninterface BrushAction {\r\n  type: string,\r\n  data: {\r\n    brush: number\r\n  }\r\n}\r\n\r\nconst initialState: BrushState = {\r\n  brush: 0,\r\n};\r\n\r\nfunction setTile(state: BrushState, brush: number): BrushState {\r\n  const newState = { ...state, brush };\r\n  return newState;\r\n}\r\n\r\nfunction brushReducer(state: BrushState = initialState, action: BrushAction): BrushState {\r\n  switch (action.type) {\r\n    case 'SET_BRUSH':\r\n      return setTile(state, action.data.brush);\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport function setBrush(brush: number): BrushAction {\r\n  return {\r\n    type: 'SET_BRUSH',\r\n    data: { brush },\r\n  };\r\n}\r\n\r\nexport default brushReducer;\r\n","import React from 'react';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { useDispatch } from 'react-redux';\r\nimport { setBrush } from '../../reducers/brushReducer';\r\nimport { Icon } from '@iconify/react';\r\nimport eraserIcon from '@iconify/icons-mdi/eraser';\r\n\r\n\r\nfunction Eraser() {\r\n    const dispatch = useDispatch();\r\n\r\n    return (\r\n        <div>\r\n            <div onClick={() => dispatch(setBrush(-1))}>\r\n                <IconButton>\r\n                    <Icon icon={eraserIcon} />\r\n                </IconButton>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Eraser;","import React from 'react';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { useDispatch } from 'react-redux';\r\nimport { undo } from '../../reducers/canvasReducer';\r\nimport UndoIcon from '@material-ui/icons/Undo';\r\n\r\nfunction Eraser() {\r\n    const dispatch = useDispatch();\r\n\r\n    return (\r\n        <div onClick={() => dispatch(undo())}>\r\n            <IconButton>\r\n                <UndoIcon />\r\n            </IconButton>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Eraser;","import React from 'react';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { useDispatch } from 'react-redux';\r\nimport { redo } from '../../reducers/canvasReducer';\r\nimport RedoIcon from '@material-ui/icons/Redo';\r\n\r\nfunction Eraser() {\r\n    const dispatch = useDispatch();\r\n\r\n    return (\r\n        <IconButton onClick={() => dispatch(redo())}>\r\n            <RedoIcon />\r\n        </IconButton>\r\n    )\r\n}\r\n\r\nexport default Eraser;","import axios from 'axios';\r\n\r\nconst url = 'http://localhost:3001';\r\n\r\nexport interface TileMap {\r\n  id?: string,\r\n  name: string,\r\n  width: number,\r\n  height: number,\r\n  tileMap: number[],\r\n  tileSet: string\r\n};\r\n\r\nexport function getAll(): Promise<any> {\r\n    return axios.get(`${url}/api/maps`)\r\n      .then(function (response) {\r\n        console.log('maps', response);\r\n        return response.data;\r\n      });\r\n};\r\n\r\nexport function saveMap(map: TileMap, token: string): Promise<any> {\r\n  console.log(token);\r\n  const headers = {\r\n    'Authorization': `Bearer ${token}`,\r\n  }\r\n\r\n  if (map.id) {\r\n    return axios.put(`${url}/api/maps/${map.id}`, map, { headers: { Authorization: `bearer ${token}` } })\r\n    .then(function (response) {\r\n      console.log('maps', response);\r\n      return response.data;\r\n    });\r\n  }\r\n\r\n  return axios.post(`${url}/api/maps`, map, { headers: { Authorization: `bearer ${token}` } })\r\n    .then(function (response) {\r\n      console.log('maps', response);\r\n      return response.data;\r\n    });\r\n};\r\n\r\nexport function deleteMap(id: string): Promise<any> {\r\n  return axios.delete(`${url}/api/maps/${id}`)\r\n    .then(function (response) {\r\n      console.log('deleted', response);\r\n      return response.data;\r\n    })\r\n}\r\n\r\nexport default { getAll, saveMap, deleteMap };","import mapsService, { TileMap } from \"../services/mapsService\";\r\nimport GridEditorThunk from \"../utils/GridEditorThunk\";\r\n\r\ninterface MapAction {\r\n  type: string,\r\n  data?: {\r\n    maps?: TileMap[],\r\n    map?: TileMap\r\n  }\r\n}\r\n\r\nfunction mapsReducer(state: TileMap[] = [], action: MapAction) {\r\n  switch (action.type) {\r\n    case 'SET_MAPS':\r\n      return action.data?.maps ? action.data.maps : state;\r\n    case 'DELETE_MAP':\r\n      const deletedMapId = action.data?.map?.id;\r\n      return deletedMapId ? state.filter(map => map.id !== deletedMapId) : state;\r\n    case 'SAVE_MAP':\r\n      const savedMap = action.data?.map;\r\n      if (savedMap) {\r\n        const index = state.reduce((prevValue, map, i) => map.id === savedMap.id ? i : prevValue, -1);\r\n        if (index >= 0) {\r\n          return state.map((map, i) => i === index ? savedMap : map);\r\n        } else {\r\n          return state.concat(savedMap);\r\n        }\r\n      }\r\n      return state;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport function initializeMaps(): GridEditorThunk {\r\n  return dispatch => {\r\n    mapsService.getAll()\r\n      .then(maps => {\r\n        dispatch({\r\n          type: 'SET_MAPS',\r\n          data: {\r\n            maps\r\n          }\r\n        })\r\n      })\r\n  }\r\n};\r\n\r\nexport function setMaps(maps: TileMap[]) {\r\n  return {\r\n    type: 'SET_MAPS',\r\n    data: {\r\n      maps\r\n    }\r\n  }\r\n}\r\n\r\nexport function deleteMap(map: TileMap) {\r\n  return {\r\n    type: 'DELETE_MAP',\r\n    data: {\r\n      map\r\n    }\r\n  }\r\n}\r\n\r\nexport function appendMap(map: TileMap) {\r\n  return {\r\n    type: 'SAVE_MAP',\r\n    data: {\r\n      map\r\n    }\r\n  }\r\n}\r\n\r\nexport default mapsReducer;","import React from 'react';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { saveMap, TileMap } from '../../services/mapsService';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { RootState } from '../../store';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport { appendMap } from '../../reducers/mapsReducer';\r\nimport { updateMap } from '../../reducers/canvasReducer';\r\n\r\nfunction Save() {\r\n  const dispatch = useDispatch();\r\n  const tileMap = useSelector((state: RootState) => state.canvas);\r\n  const token = useSelector((state: RootState) => state.user.token);\r\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\r\n  const map: TileMap = { ...tileMap.tileMap, tileMap: tileMap.history[tileMap.current], tileSet: tileSetName };\r\n\r\n  function save(): void {\r\n    token && saveMap(map, token)\r\n      .then(savedMap => {\r\n        console.log('map saved', savedMap);\r\n        dispatch(updateMap(savedMap));\r\n        dispatch(appendMap(savedMap));\r\n      });\r\n  }\r\n\r\n  return (\r\n    <IconButton onClick={() => save()} disabled={!token}>\r\n      <SaveIcon />\r\n    </IconButton>\r\n  )\r\n}\r\n\r\nexport default Save;","import React from 'react';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { useHistory } from 'react-router-dom';\r\nimport StorageIcon from '@material-ui/icons/Storage';\r\n\r\nfunction Load() {\r\n  const history = useHistory();\r\n\r\n  return (\r\n    <IconButton onClick={() => history.push('/maps')}>\r\n      <StorageIcon />\r\n    </IconButton>\r\n  );\r\n};\r\n\r\nexport default Load;","import * as React from 'react';\r\nimport { Modal, IconButton } from '@material-ui/core';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport Grid from '../Grid';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { RootState } from '../../store';\r\nimport Tile from '../Tile';\r\nimport { setBrush } from '../../reducers/brushReducer';\r\nimport tileSets from '../../services/tileSets';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => createStyles({\r\n  window: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    transform: 'translate(-50%, -50%)',\r\n    transformOrigin: 'center',\r\n  },\r\n}));\r\n\r\nexport interface Props {\r\n  setOpen: Function,\r\n  open: boolean\r\n}\r\n\r\nfunction Palette() {\r\n  const classes = useStyles();\r\n  const dispatch = useDispatch();\r\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\r\n  const tileSet = tileSets[tileSetName];\r\n  const mapping = tileSet.mapping;\r\n  const brush = useSelector((state: RootState) => state.tools.brush);\r\n\r\n  const [open, setOpen] = React.useState(false);\r\n\r\n  function palette(): any {\r\n    return Array(tileSet.tiles).fill(0).map((n: number, index: number) => (\r\n      <div key={index} onClick={() => dispatch(setBrush(index))}>\r\n        <Tile {...mapping[index]} />\r\n      </div>\r\n    ));\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div id={'selectedBrush'} onClick={() => setOpen(true)}>\r\n        <IconButton>\r\n          <Grid columns={1} rows={1} tileHeight={tileSet.tileHeight} tileWidth={tileSet.tileWidth} scale={24/tileSet.tileWidth} >\r\n            {brush >= 0\r\n            && <Tile {...mapping[brush]} />}\r\n          </Grid>\r\n        </IconButton>\r\n      </div>\r\n      \r\n      <div onClick={() => setOpen(false)}>\r\n        <Modal open={open} onClose={() => setOpen(false)} >\r\n          <div className={classes.window} >\r\n            <Grid columns={tileSet.tilesPerRow} rows={tileSet.tilesPerColumn} tileHeight={tileSet.tileHeight} tileWidth={tileSet.tileWidth} scale={32 / tileSet.tileWidth} >\r\n              {palette()}\r\n            </Grid>\r\n          </div>\r\n        </Modal>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Palette;\r\n","import React, { ReactElement } from 'react';\r\nimport Eraser from './Eraser';\r\nimport Undo from './Undo';\r\nimport Redo from './Redo';\r\nimport Save from './Save';\r\nimport Load from './Load';\r\nimport Palette from './Palette';\r\nimport { List, ListItem } from '@material-ui/core';\r\n\r\n\r\nconst tools = [\r\n  <Load />,\r\n  <Save />,\r\n  <Undo />,\r\n  <Redo />,\r\n  <Eraser />,\r\n  <Palette />\r\n];\r\n\r\nfunction Tools() {\r\n  return (\r\n        <List id='tools'>\r\n          {tools.map((tool: ReactElement, index: number) => {\r\n              return (\r\n                <ListItem key={index}>\r\n                  {tool}\r\n                </ListItem>\r\n              )\r\n            }\r\n          )}\r\n        </List>\r\n  );\r\n}\r\n\r\nexport default Tools;\r\n","import React from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport {\r\n  makeStyles, Theme, createStyles, Drawer,\r\n} from '@material-ui/core';\r\nimport Tools from './Tools';\r\nimport { RootState } from '../store';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => createStyles({\r\n  root: {\r\n    display: 'flex',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n  },\r\n  drawer: {\r\n    // width: 300,\r\n    flexShrink: 0,\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n  tool: {\r\n    marginRight: '1em',\r\n  },\r\n  content: {\r\n    margin: 'auto',\r\n  },\r\n  toolbarMargin: theme.mixins.toolbar,\r\n}));\r\n\r\ninterface Props {\r\n  image?: string,\r\n  mapping?: any,\r\n  children?: React.ReactNode\r\n}\r\n\r\nfunction ToolBar({ children }: Props) {\r\n  const brush = useSelector((state: RootState) => state.tools.brush);\r\n  console.log('brush', brush);\r\n  const classes = useStyles();\r\n\r\n  return (\r\n        <div className={classes.root}>\r\n\r\n            <div className={classes.content}>\r\n\r\n                <Drawer variant=\"permanent\">\r\n                  <div className={classes.toolbarMargin} />\r\n                  <Tools />\r\n                </Drawer>\r\n\r\n                <div className={classes.content}>\r\n                  {children}\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n  );\r\n}\r\n\r\nexport default ToolBar;\r\n","import React from 'react';\r\nimport { Card, CardActionArea, CardMedia, CardContent, Typography, CardActions, Button, Theme, createStyles, makeStyles } from '@material-ui/core';\r\nimport Grid from './Grid';\r\nimport { TileMap, deleteMap } from '../services/mapsService';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport { deleteMap as cutMap } from '../reducers/mapsReducer';\r\nimport Tile from './Tile';\r\nimport { load } from '../reducers/canvasReducer';\r\nimport tileSets from '../services/tileSets';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => createStyles({\r\n  map: {\r\n    margin: '1em'\r\n  },\r\n  mapThumbnail: {\r\n    display: 'flex',\r\n    height: '10em',  \r\n    overflow: 'hidden',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    margin: '0.5em'\r\n  }\r\n}));\r\n\r\ninterface Props {\r\n  map: TileMap\r\n}\r\n\r\nfunction MapCard({ map }: Props) {\r\n  const history = useHistory();\r\n  const tileSet = tileSets[map.tileSet];\r\n  const mapping = tileSet.mapping;\r\n  const dispatch = useDispatch();\r\n  const classes = useStyles();\r\n\r\n  function parseMap(map: TileMap) {\r\n    return map.tileMap.map((tile: number, index: number) => (\r\n      <div key={index}>\r\n        {tile >= 0 && <Tile {...mapping[tile]} />}\r\n      </div>\r\n    ));\r\n  }\r\n\r\n  function removeMap(map: TileMap) {\r\n    dispatch(cutMap(map));\r\n    map.id && deleteMap(map.id);\r\n  }\r\n\r\n  function clickHandler() {\r\n    dispatch(load(map));\r\n    history.push('/');\r\n  }\r\n\r\n  return (\r\n    <Card className={classes.map} key={map.name}>\r\n      <CardActionArea onClick={() => clickHandler()}>\r\n        <CardMedia>\r\n          <div className={classes.mapThumbnail}>\r\n            <Grid rows={map.height} columns={map.width} tileHeight={tileSet.tileHeight} tileWidth={tileSet.tileWidth} scale={8/tileSet.tileWidth} >\r\n              {parseMap(map)}\r\n            </Grid>\r\n          </div>\r\n        </CardMedia>\r\n        <CardContent>\r\n          <Typography variant=\"h6\">\r\n            {map.name}\r\n          </Typography>\r\n        </CardContent>\r\n      </CardActionArea>\r\n\r\n      <CardActions>\r\n        <Button component={Link} to={'/'} onClick={() => dispatch(load(map))}>\r\n          Load\r\n          </Button>\r\n        <Button onClick={() => removeMap(map)}>\r\n          Delete\r\n          </Button>\r\n      </CardActions>\r\n    </Card>\r\n  )\r\n};\r\n\r\nexport default MapCard;","import * as React from 'react';\r\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\r\nimport { useEffect } from 'react';\r\nimport { TileMap, } from '../services/mapsService';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { RootState } from '../store';\r\nimport { initializeMaps } from '../reducers/mapsReducer';\r\nimport MapCard from './MapCard';\r\n\r\nconst useStyles = makeStyles(() => createStyles({ \r\n    map: {\r\n      margin: '1em',\r\n    },\r\n    mapList: {\r\n      display: 'flex'\r\n    }\r\n}));\r\n\r\nfunction Maps() {\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    dispatch(initializeMaps());\r\n  }, [dispatch]);\r\n\r\n  const maps = useSelector((state: RootState) => state.maps);\r\n  const classes = useStyles();\r\n\r\n  function parsedMaps() {\r\n    return (\r\n      maps.map((map: TileMap) => <MapCard key={map.id} map={map} />)\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={classes.mapList}>\r\n      {parsedMaps()}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Maps;\r\n","import React, { useState } from 'react';\r\nimport { TextField, makeStyles, Theme, createStyles, Button, Select, MenuItem, InputLabel, FormControl } from '@material-ui/core';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { RootState } from '../../store';\r\nimport { updateMap, load } from '../../reducers/canvasReducer';\r\nimport { TileMap } from '../../services/mapsService';\r\nimport tileSets from '../../services/tileSets';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => createStyles({\r\n  form: {\r\n    display: 'grid',\r\n    gridGap: '2em',\r\n    background: 'white',\r\n    padding: '2em'\r\n  },\r\n}));\r\n\r\nfunction Settings() {\r\n  const tileMap = useSelector((state: RootState) => state.canvas.tileMap);\r\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\r\n  const dispatch = useDispatch();\r\n  const classes = useStyles();\r\n\r\n  const [name, setName] = useState(tileMap.name);\r\n  const [width, setWidth] = useState(tileMap.width);\r\n  const [height, setHeight] = useState(tileMap.height);\r\n  const [tileSet, setTileSet] = useState(tileSetName);\r\n\r\n  const tileSetNames = () => {\r\n    return Object.keys(tileSets).map((tileSet: string) => {\r\n      return <MenuItem key={tileSet} value={tileSet}>{tileSet}</MenuItem>\r\n    });\r\n  };\r\n\r\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    console.log(event.target.value);\r\n    setTileSet(event.target.value as string);\r\n  };\r\n\r\n  const handleSave = (event: React.FormEvent<HTMLButtonElement>) => {\r\n    event.preventDefault();\r\n    dispatch(updateMap({ ...tileMap, name, width, height, tileSet }));\r\n  };\r\n\r\n  const handleCreateNew = (event: React.FormEvent<HTMLButtonElement>) => {\r\n    event.preventDefault();\r\n\r\n    const newMap: TileMap = {\r\n      tileSet,\r\n      name: 'New Map',\r\n      width,\r\n      height,\r\n      tileMap: new Array(width * height).fill(-1),\r\n    }\r\n\r\n    console.log('creating new map', newMap);\r\n    dispatch(load(newMap));\r\n    setName('New Map');\r\n  };\r\n\r\n  return (\r\n    <div className={classes.form} >\r\n      <TextField label='Name' variant='outlined' defaultValue={name} onChange={(event) => setName(event.target.value)} />\r\n      <TextField label='Width' type='number' variant='outlined' defaultValue={width} onChange={(event) => setWidth(Number.parseInt(event.target.value))} />\r\n      <TextField label='Height' type='number' variant='outlined' defaultValue={height} onChange={(event) => setHeight(Number.parseInt(event.target.value))} />\r\n      <FormControl variant='outlined'>\r\n        <InputLabel id='select-tileset-label'>Tile Set</InputLabel>\r\n        <Select labelId='select-tileset-label' label='Tileset' value={tileSet} variant='outlined' onChange={(event) => handleChange(event)}>\r\n          {tileSetNames()}\r\n        </Select>\r\n      </FormControl>\r\n      <Button type=\"submit\" variant='contained' color='primary' onClick={(event) => handleSave(event)} >Apply Changes</Button>\r\n      <Button type=\"submit\" variant='outlined' onClick={(event) => handleCreateNew(event)} >Create New</Button>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Settings;","import React, { useState } from 'react';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { Modal, makeStyles, Theme, createStyles } from '@material-ui/core';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport Settings from './Settings';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => createStyles({\r\n  window: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    transform: 'translate(-50%, -50%)',\r\n    transformOrigin: 'center',\r\n  }\r\n}));\r\n\r\nfunction Edit() {\r\n  const [open, setOpen] = useState(false);\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div>\r\n      <IconButton onClick={() => setOpen(true)}>\r\n        <EditIcon />\r\n      </IconButton>\r\n\r\n      <Modal open={open} onClose={() => setOpen(false)} >\r\n        <div className={classes.window} >\r\n          <Settings />\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Edit;","export interface User {\r\n    name?: string,\r\n    id?: string,\r\n    token?: string\r\n} \r\n\r\ninterface UserAction {\r\n    type: string,\r\n    data: {\r\n        name: string,\r\n        id: string,\r\n        token: string\r\n    }\r\n}\r\n\r\nfunction userReducer(state: User = {}, action: UserAction) {\r\n    switch (action.type) {\r\n        case ('LOGIN'):\r\n            return action.data;\r\n        case ('LOGOUT'):\r\n            return {};\r\n        default:\r\n          return state;\r\n      }\r\n}\r\n\r\nexport function login(id: string, name: string, token: string) {\r\n    return {\r\n        type: 'LOGIN',\r\n        data: {\r\n            name,\r\n            id,\r\n            token\r\n        }\r\n    }\r\n}\r\n\r\nexport function logout() {\r\n    return {\r\n        type: 'LOGOUT'\r\n    }\r\n}\r\n\r\nexport default userReducer;","import React from 'react';\r\nimport GoogleLogin from 'react-google-login';\r\nimport { useDispatch } from 'react-redux';\r\nimport { login } from '../reducers/userReducer';\r\n\r\nfunction Login() {\r\n  const dispatch = useDispatch();\r\n\r\n  const responseGoogle = (response: any) => {\r\n    console.log(response);\r\n    if (response.error) return;\r\n    dispatch(login(response.googleId, response.profileObj.name, response.accessToken));\r\n  }\r\n\r\n  return (\r\n      <GoogleLogin\r\n        clientId=\"566902547666-7bdampp3nip1c2pmp3bh7jp1bocpfg38.apps.googleusercontent.com\"\r\n        buttonText=\"Login\"\r\n        onSuccess={responseGoogle}\r\n        onFailure={responseGoogle}\r\n        cookiePolicy={'single_host_origin'}\r\n        isSignedIn={true}\r\n      />\r\n  )\r\n}\r\n\r\nexport default Login;","import React from 'react';\r\nimport { GoogleLogout } from 'react-google-login';\r\nimport { useDispatch } from 'react-redux';\r\nimport { logout } from '../reducers/userReducer';\r\n\r\n\r\nfunction Logout() {\r\n  const dispatch = useDispatch();\r\n\r\n  const handleLogout = () => {\r\n    dispatch(logout());\r\n    console.log('logged out');\r\n  }\r\n\r\n  return (\r\n    <GoogleLogout\r\n      clientId=\"566902547666-7bdampp3nip1c2pmp3bh7jp1bocpfg38.apps.googleusercontent.com\"\r\n      buttonText=\"Logout\"\r\n      onLogoutSuccess={handleLogout}\r\n    >\r\n    </GoogleLogout>\r\n  )\r\n}\r\n\r\nexport default Logout;","import React from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Switch, Route, useHistory } from 'react-router-dom';\r\nimport {\r\n  AppBar, Toolbar, Typography, makeStyles, Theme, createStyles, Grid as MUIGrid, Button, IconButton,\r\n} from '@material-ui/core';\r\nimport { RootState } from '../store';\r\nimport Edit from './Tools/Edit';\r\nimport { Link } from 'react-router-dom';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport Login from './Login';\r\nimport Logout from './Logout';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => createStyles({\r\n  root: {\r\n    display: 'flex',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n    '&:hover': {\r\n      cursor: 'pointer',\r\n    },\r\n  },\r\n  content: {\r\n    margin: 'auto',\r\n  },\r\n  toolbarMargin: theme.mixins.toolbar,\r\n}));\r\n\r\ninterface Props {\r\n  image?: string,\r\n  mapping?: any,\r\n  children?: React.ReactNode\r\n}\r\n\r\nfunction TopBar({ children }: Props) {\r\n  const mapName = useSelector((state: RootState) => state.canvas.tileMap.name);\r\n  const user = useSelector((state: RootState) => state.user);\r\n  const history = useHistory();\r\n  const classes = useStyles();\r\n\r\n  const canvasName = () => {\r\n    return (\r\n      <MUIGrid container alignItems='center' >\r\n        <MUIGrid item >\r\n          <Edit />\r\n        </MUIGrid>\r\n        <MUIGrid item >\r\n          <Typography variant='h6' display='inline' align='justify'>{mapName}</Typography>\r\n        </MUIGrid>\r\n      </MUIGrid>\r\n    )\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n\r\n      <AppBar color='default' position='absolute' className={classes.appBar}>\r\n        <Toolbar>\r\n          <MUIGrid\r\n            container\r\n            direction=\"row\"\r\n            justify=\"space-between\"\r\n            alignItems=\"center\"\r\n          >\r\n\r\n            <MUIGrid item xs={3} >\r\n              <Typography variant=\"h6\" className={classes.title} onClick={() => history.push('/')}>\r\n                Grid Editor\r\n              </Typography>\r\n            </MUIGrid>\r\n\r\n            <MUIGrid item>\r\n              \r\n                <Switch>\r\n                  <Route exact path='/login' />\r\n                    \r\n                  <Route exact path='/maps'>\r\n                    <IconButton onClick={() => history.push('/')}>\r\n                      <CancelIcon/>\r\n                    </IconButton>\r\n                  </Route>\r\n\r\n                  <Route exact path='/'>\r\n                    {canvasName()}\r\n                  </Route>\r\n                </Switch>\r\n\r\n            </MUIGrid>\r\n\r\n            <MUIGrid item xs={3} style={{ textAlign: 'right' }}>\r\n              {!user.token && <Login />}\r\n              {user.token && <Logout />}\r\n            </MUIGrid>\r\n\r\n          </MUIGrid>\r\n        </Toolbar>\r\n      </AppBar>\r\n\r\n      <div className={classes.content}>\r\n        <div className={classes.toolbarMargin} />\r\n        {children}\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TopBar;\r\n","import * as React from 'react';\r\nimport Canvas from './components/Canvas';\r\nimport ToolBar from './components/ToolBar';\r\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\r\nimport Maps from './components/Maps';\r\nimport TopBar from './components/TopBar';\r\nimport Login from './components/Login';\r\n\r\nfunction App() {\r\n  return (\r\n    <Router>\r\n      <TopBar>\r\n        <Switch>\r\n          <Route exact path='/login'><Login /></Route>\r\n          <Route exact path='/'>\r\n            <ToolBar>\r\n              <Canvas />\r\n            </ToolBar>\r\n          </Route>\r\n          <Route path='/maps'><Maps /></Route>\r\n        </Switch>\r\n      </TopBar>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import tileSets from '../services/tileSets';\r\nimport { TileMap } from '../services/mapsService';\r\n\r\nexport interface TileSetAction {\r\n  type: string,\r\n  data: {\r\n    tileSet?: string,\r\n    tileMap?: TileMap\r\n  }\r\n}\r\n\r\nfunction tileSetReducer(state: string = 'Harbour', action: TileSetAction) {\r\n  switch (action.type) {\r\n    case 'SET_TILESET':\r\n      return action.data.tileSet || state;\r\n    case 'LOAD_MAP':\r\n    case 'UPDATE_MAP':\r\n      console.log('TileSet', action.data);\r\n      return action.data?.tileMap ? action.data.tileMap.tileSet : state;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport function setTileSet(tileSet: string) {\r\n  return {\r\n    type: 'SET_TILESET',\r\n    data: { tileSet: tileSets.tileSet }\r\n  };\r\n}\r\n\r\nexport default tileSetReducer;","import { createStore, combineReducers, applyMiddleware } from 'redux';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport canvasReducer, { CanvasState } from './reducers/canvasReducer';\r\nimport brushReducer, { BrushState } from './reducers/brushReducer';\r\nimport tileSetReducer from './reducers/tileSetReducer';\r\nimport mapsReducer from './reducers/mapsReducer';\r\nimport { TileMap } from './services/mapsService';\r\nimport userReducer, { User } from './reducers/userReducer';\r\nimport thunk from 'redux-thunk'\r\n\r\nexport interface RootState {\r\n  user: User,\r\n  tileSet: string,\r\n  canvas: CanvasState,\r\n  tools: BrushState,\r\n  maps: TileMap[]\r\n}\r\n\r\nconst reducer = combineReducers({\r\n  user: userReducer,\r\n  tileSet: tileSetReducer,\r\n  canvas: canvasReducer,\r\n  tools: brushReducer,\r\n  maps: mapsReducer\r\n});\r\n\r\nconst store = createStore(\r\n  reducer,\r\n  composeWithDevTools(\r\n    applyMiddleware(thunk)\r\n  ));\r\nconsole.log('store', store.getState());\r\n\r\nexport default store;\r\n","import * as React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport App from './App';\r\nimport store from './store';\r\n\r\nconst render = () => ReactDOM.render(\r\n  <Provider store={store} >\r\n      <App />\r\n  </Provider>,\r\n  document.getElementById('root'),\r\n);\r\n\r\nrender();\r\nstore.subscribe(render);\r\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACd0lEQVR42u1a2Y6EMAzj/3969mlH2lHbOLaTdmGQkPagEFzHubiu63qtzuojen7DGV/0aAC+DGg8VQDJtZxhyLWRYaO1nQDaGaBS+3edyoAyEVw9hKXlvwOgYudnALAMTK3LIov6N2PM6BkzlmTvmQZg9JKM8DgY8AnGChzErawa0AEAygRqnSoupzMgdImsC5ysARQAqrrelgFuDRjdIxIshwbYXcDBgCgVbmVANr1lqR3tble1OWRAZX6PZpJq9ogWbVMAUDSrGMBmdeUAOKtEZxXY5gJuABQGOER4CcCudtVWAHa0sZwgbwfghC6S7AKndG27Gi/Hd4XVxmwaAGb3KxiC9BvRtngZAFFRFP2uJFJIvUJsoJZ2Ii+fASAzL0ASKICtXKyuEkm0aMowJLCdz8GVmsANALppg79zWdpJDBD/70mD3cORtnNEi2yJnDE+cqeZ324DwMmAKM5vB2AWPtA4jLStkXKZHYFRXWgnAO4BKRuSU3a4XEDRgKjjO/tZmSq/r3WJoKIBaMsbcSOk8/RxrS8MshrAAIACEoKFagD7UgyDlMlTGhAXAEh4y9w/01KL6B8USJoLqBMfdvDB6MEQACcDZrlBR/c4sntqm1MDGIo7gBDZ63GBzBjcXU2imze0pyIKuAFAtQIVvj/XdoXBrn4CCox1MuQaWihfqkrVYHbXs3lAppqs6D4Fa+tbWFEcR+K6UnAtAYw0APEpJg/Ifv7mdNWyz+UFIyTKix1qPIFRR+CZ9Lcyo6Q1gH35lctsH7WHiULjJNjVjk92rePBwd2PKIQ9A4BFnL4/AI93gShMPAKARVr6LAaMvqP7AnDj4weKUYv+/6aLvgAAAABJRU5ErkJggg==\""],"sourceRoot":""}