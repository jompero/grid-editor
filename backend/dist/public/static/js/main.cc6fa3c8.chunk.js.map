{"version":3,"sources":["utils/auth.ts","services/usersService.ts","reducers/canvasReducer.ts","components/Grid.tsx","utils/tileMapping.ts","services/tileSets.ts","components/Tile.tsx","components/ClickableTile.tsx","components/Canvas.tsx","reducers/brushReducer.ts","components/Tools/Eraser.tsx","components/Tools/Undo.tsx","components/Tools/Redo.tsx","services/mapsService.ts","reducers/notificationsReducer.ts","reducers/mapsReducer.ts","components/Tools/Save.tsx","components/Tools/Load.tsx","components/Tools/Palette.tsx","components/Tools/index.tsx","components/ToolBar.tsx","components/MapLikeButton.tsx","components/MapCard.tsx","reducers/mapsFilterReducer.ts","components/MapsFilter.tsx","components/Maps.tsx","components/Tools/Settings.tsx","components/Tools/Edit.tsx","reducers/userReducer.ts","components/Login.tsx","components/Logout.tsx","components/TopBar.tsx","components/Notification.tsx","reducers/themeReducer.ts","App.tsx","reducers/tileSetReducer.ts","store.tsx","index.tsx","tileSets/revolution_tiles.png","tileSets/bw_tiles.png"],"names":["auth","token","Authorization","NoUser","name","profile","url","process","login","axios","post","headers","then","response","data","nullState","width","height","tileSet","tileMap","Array","fill","user","paint","state","position","newTile","newMap","map","oldTile","index","load","type","updateMap","undoableCanvas","undoable","action","target","tile","Grid","children","columns","rows","tileHeight","tileWidth","scale","classes","makeStyles","createStyles","gridContainer","display","gridTemplateColumns","gridTemplateRows","transformOrigin","transform","useStyles","className","React","child","computeTilesPerRow","imageWidth","Math","floor","getPosY","tilesPerRow","getPosX","getTileProps","image","imageHeight","posY","posX","getPos","getMapping","tiles","n","Harbour","cityImage","tilesPerColumn","mapping","Cave","caveImage","tileSets","Tile","color","backgroundImage","backgroundColor","backgroundPosition","imageRendering","data-testid","cursor","ClickableTile","onMouseClick","tileSetName","useSelector","canvas","present","key","onMouseDown","Canvas","dispatch","useDispatch","brush","tools","paintTile","initialState","setTile","setBrush","brushReducer","Eraser","onClick","IconButton","icon","eraserIcon","ActionCreators","undo","redo","getAll","get","saveMap","id","put","deleteMap","delete","likeMap","unlikeMap","notify","message","severity","undefined","notificationsReducer","mapsReducer","maps","deletedMapId","filter","savedMap","reduce","prevValue","i","concat","likedMap","Save","appendMap","catch","error","disabled","Load","history","useHistory","push","theme","window","background","palette","default","zIndex","top","left","boxShadow","transition","Palette","open","setOpen","Modal","onClose","style","Tools","List","tool","ListItem","root","appBar","drawer","flexShrink","title","flexGrow","marginRight","content","margin","toolbarMargin","mixins","toolbar","ToolBar","Drawer","variant","container","flexDirection","alignItems","MapLikeButton","liked","likes","includes","like","unlike","Typography","length","minWidth","maxWidth","mapThumbnail","overflow","justifyContent","MapCard","Card","CardActionArea","clearHistory","CardMedia","CardContent","CardActions","Button","cutMap","mapToRemove","text","users","setFilter","mapsFilterReducer","form","padding","searchField","flex","userFilter","MapsFilter","mapsFilter","usersAcc","some","foundUser","FormControl","fullWidth","TextField","label","size","value","onChange","event","InputLabel","Select","labelId","autoWidth","multiple","MenuItem","mapList","Maps","useEffect","filteredMaps","toLowerCase","parsedMaps","gridGap","Settings","handleSubmit","useState","setName","setWidth","setHeight","setTileSet","defaultValue","Number","parseInt","handleChange","Object","keys","preventDefault","handleSave","handleCreateNew","Edit","userReducer","Login","responseGoogle","profileObj","accessToken","googleId","userLogin","assign","err","clientId","buttonText","onSuccess","onFailure","cookiePolicy","isSignedIn","Logout","onLogoutSuccess","marginTop","TopBar","mapName","AppBar","Toolbar","direction","justify","item","xs","exact","path","align","textAlign","Notification","notification","Snackbar","autoHideDuration","anchorOrigin","vertical","horizontal","Alert","themeReducer","App","userPreference","useMediaQuery","toggleDarkMode","createMuiTheme","ThemeProvider","CssBaseline","tileSetReducer","reducer","combineReducers","canvasReducer","store","createStore","composeWithDevTools","applyMiddleware","thunk","getState","ReactDOM","render","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.cc6fa3c8.chunk.js","sourcesContent":["export default function auth(token: string) {\n  return {\n    Authorization: `bearer ${token}`,\n  };\n}\n","import axios from 'axios';\nimport Debug from '../utils/Debug';\nimport auth from '../utils/auth';\n\nexport interface User {\n  name: string,\n  id?: string,\n  token: string,\n  profile: string\n}\n\nexport const NoUser = {\n  name: '',\n  token: '',\n  profile: '',\n};\n\nconst url = process.env.NODE_ENV === 'development'\n  ? 'http://localhost:3001'\n  : process.env.REACT_APP_BASE_URL;\n\nexport function getAll(): Promise<any> {\n  return axios.get(`${url}/api/users`)\n    .then((response) => {\n      Debug('users', response.data);\n      return response.data;\n    });\n}\n\nexport function login(token: string) {\n  return axios.post(`${url}/api/users/login`, null, { headers: auth(token) })\n    .then((response) => {\n      Debug('logging in as: ', response.data);\n      return response.data;\n    });\n}\n\nexport default { getAll, login };\n","import undoable from 'redux-undo';\nimport { TileMap } from '../services/mapsService';\nimport { NoUser } from '../services/usersService';\n\ninterface CanvasAction {\n  type: string,\n  data?: {\n    target: {\n      index: number,\n      tile: number\n    }\n    tileMap?: TileMap,\n  }\n}\n\nconst nullState: TileMap = {\n  name: 'New Map',\n  width: 16,\n  height: 16,\n  tileSet: 'Harbour',\n  tileMap: new Array(16 * 16).fill(-1),\n  user: NoUser,\n};\n\nfunction paint(state: TileMap, position: number, newTile: number): TileMap {\n  const currentMap = state.tileMap;\n  const newMap = currentMap.map((oldTile, index) => (index === position ? newTile : oldTile));\n  return { ...state, tileMap: newMap };\n}\n\nfunction canvasReducer(state: TileMap = nullState as any, action: CanvasAction): TileMap {\n  switch (action.type) {\n    case 'LOAD_MAP': {\n      return action.data?.tileMap || state;\n    }\n    case 'UPDATE_MAP': {\n      let newMap = action.data?.tileMap;\n      if (newMap && (newMap.width !== state.width || newMap.height !== state.height)) {\n        newMap = { ...newMap, tileMap: new Array(newMap.width * newMap.height).fill(-1) };\n      }\n      return newMap || state;\n    }\n    case 'SET_TILE': {\n      return action.data?.target\n        ? paint(state, action.data.target.index, action.data.target.tile)\n        : state;\n    }\n    default: {\n      return state;\n    }\n  }\n}\n\nexport function paintTile(index: number, tile: number) {\n  return {\n    type: 'SET_TILE',\n    data: {\n      target: {\n        index, tile,\n      },\n    },\n  };\n}\n\nexport function load(tileMap: TileMap) {\n  return {\n    type: 'LOAD_MAP',\n    data: {\n      tileMap,\n    },\n  };\n}\n\nexport function updateMap(map: TileMap) {\n  return {\n    type: 'UPDATE_MAP',\n    data: {\n      tileMap: map,\n    },\n  };\n}\n\nconst undoableCanvas = undoable(canvasReducer);\n\nexport default undoableCanvas;\n","import * as React from 'react';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport Debug from '../utils/Debug';\n\nexport interface Props {\n  rows: number,\n  columns: number,\n  tileHeight: number,\n  tileWidth: number,\n  scale: number,\n  children: React.ReactNode\n}\n\nfunction Grid({\n  children, columns, rows, tileHeight, tileWidth, scale,\n}: Props) {\n  Debug('columns', columns, 'rows', rows);\n\n  const useStyles = makeStyles(() => createStyles({\n    gridContainer: {\n      display: 'inline-grid',\n      gridTemplateColumns: `repeat(${columns}, ${tileWidth * scale}px [col-start])`,\n      gridTemplateRows: `repeat(${rows}, ${tileHeight * scale}px [row-start])`,\n    },\n    children: {\n      transformOrigin: 'top left',\n      transform: `scale(${scale})`,\n    },\n  }));\n\n  const classes = useStyles();\n\n  function styledChildren(): any {\n    return React.Children.map(children, (child) => <div className={classes.children}>{child}</div>);\n  }\n\n  return (\n        <div className={classes.gridContainer}>\n            {styledChildren()}\n        </div>\n  );\n}\n\nexport default Grid;\n","import { Props as TileProps } from '../components/Tile';\n\nexport function computeTilesPerRow(imageWidth: number, tileWidth: number): number {\n  return Math.floor(imageWidth / tileWidth);\n}\n\nexport function computeTilesPerColumn(imageHeight: number, tileHeight: number) {\n  return Math.floor(imageHeight / tileHeight);\n}\n\nfunction getPosY(tileHeight: number, tilesPerRow: number, index: number) {\n  return Math.floor(index / tilesPerRow) * tileHeight;\n}\n\nfunction getPosX(tileWidth: number, tilesPerRow: number, index: number) {\n  return (index % tilesPerRow) * tileWidth;\n}\n\nfunction getPos(tileHeight: number, tileWidth: number, tilesPerRow: number, index: number) {\n  return {\n    posY: getPosY(tileHeight, tilesPerRow, index),\n    posX: getPosX(tileWidth, tilesPerRow, index),\n  };\n}\n\nfunction getTileProps(\n  index: number,\n  image: string,\n  tilesPerRow: number,\n  imageHeight: number,\n  tileHeight: number,\n  tileWidth: number,\n): TileProps {\n  return {\n    image,\n    ...getPos(tileHeight, tileWidth, tilesPerRow, index),\n    width: tileWidth,\n    height: tileHeight,\n  };\n}\n\nfunction getMapping(\n  image: string,\n  tilesPerRow: number,\n  imageHeight: number,\n  tileWidth: number,\n  tileHeight: number,\n  tiles: number,\n): TileProps[] {\n  return new Array(tiles)\n    .fill(0)\n    .map((n: number, index: number) => getTileProps(\n      index,\n      image,\n      tilesPerRow,\n      imageHeight,\n      tileHeight,\n      tileWidth,\n    ));\n}\n\nexport default getMapping;\n","import cityImage from '../tileSets/revolution_tiles.png';\nimport caveImage from '../tileSets/bw_tiles.png';\nimport { Props as TileProps } from '../components/Tile';\nimport getMapping, { computeTilesPerRow } from '../utils/tileMapping';\n\nexport interface TileSet {\n  name: string,\n  image: string,\n  imageWidth: number,\n  imageHeight: number,\n  tileWidth: number,\n  tileHeight: number,\n  tiles: number,\n  tilesPerRow: number,\n  tilesPerColumn: number,\n  mapping: TileProps[]\n}\n\nconst Harbour: TileSet = {\n  name: 'City',\n  image: cityImage,\n  imageWidth: 64,\n  imageHeight: 80,\n  tileWidth: 8,\n  tileHeight: 8,\n  tiles: 78,\n  tilesPerRow: 0,\n  tilesPerColumn: 0,\n  mapping: [],\n};\n\nHarbour.tilesPerRow = computeTilesPerRow(Harbour.imageWidth, Harbour.tileWidth);\nHarbour.tilesPerColumn = computeTilesPerRow(Harbour.imageHeight, Harbour.tileHeight);\nHarbour.mapping = getMapping(\n  Harbour.image,\n  Harbour.tilesPerRow,\n  Harbour.imageHeight,\n  Harbour.tileWidth,\n  Harbour.tileHeight,\n  Harbour.tiles,\n);\n\nconst Cave: TileSet = {\n  name: 'Cave',\n  image: caveImage,\n  imageWidth: 64,\n  imageHeight: 56,\n  tileWidth: 8,\n  tileHeight: 8,\n  tiles: 50,\n  tilesPerRow: 0,\n  tilesPerColumn: 0,\n  mapping: [],\n};\n\nCave.tilesPerRow = computeTilesPerRow(Cave.imageWidth, Cave.tileWidth);\nCave.tilesPerColumn = computeTilesPerRow(Cave.imageHeight, Cave.tileHeight);\nCave.mapping = getMapping(\n  Cave.image,\n  Cave.tilesPerRow,\n  Cave.imageHeight,\n  Cave.tileWidth,\n  Cave.tileHeight,\n  Cave.tiles,\n);\n\nconst tileSets = {\n  Harbour,\n  Cave,\n} as {\n  [key: string]: TileSet\n};\n\nexport default tileSets;\n","import * as React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core';\n\nexport interface Props {\n  image?: string;\n  color?: string;\n  posX?: number;\n  posY?: number;\n  width: number;\n  height: number;\n}\n\nfunction Tile({\n  image, color, posX, posY, width, height,\n}: Props) {\n  const useStyles = makeStyles(() => createStyles({\n    tile: {\n      backgroundImage: `url(${image})`,\n      backgroundColor: `${color}`,\n      backgroundPosition: `-${posX}px -${posY}px`,\n      width,\n      height,\n      imageRendering: 'pixelated',\n    },\n  }));\n\n  const classes = useStyles();\n\n  return (\n    <div data-testid='tile' className={classes.tile} />\n  );\n}\n\nexport default Tile;\n","import * as React from 'react';\nimport { useSelector } from 'react-redux';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport Tile from './Tile';\nimport tileSets from '../services/tileSets';\nimport { RootState } from '../store';\n\nexport interface Props {\n  index: number;\n  onMouseClick: Function;\n}\n\nconst useStyles = makeStyles(() => createStyles({\n  tile: {\n    '&:hover': {\n      cursor: 'pointer',\n    },\n  },\n}));\n\nfunction ClickableTile({ index, onMouseClick }: Props) {\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\n  const tile = useSelector((state: RootState) => state.canvas.present.tileMap[index]);\n  const columns = useSelector((state: RootState) => state.canvas.present.width);\n  const tileSet = tileSets[tileSetName];\n  const { mapping } = tileSet;\n\n  const classes = useStyles();\n\n  const color = () => {\n    const tileValue = (index % columns) + Math.floor(index / columns);\n    // console.log('index', index, 'tileValue', tileValue);\n    return {\n      color: tileValue % 2 === 0 ? 'GREY' : 'WHITE',\n      width: tileSet.tileWidth,\n      height: tileSet.tileHeight,\n    };\n  };\n\n  return (\n    <div\n      key={index}\n      onMouseDown={() => onMouseClick()}\n      className={classes.tile}\n    >\n      {tile >= 0 && <Tile {...mapping[tile]} />}\n      {tile === -1 && <Tile {...color()} />}\n    </div>\n  );\n}\n\nexport default ClickableTile;\n","import * as React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { paintTile } from '../reducers/canvasReducer';\nimport Grid from './Grid';\nimport { RootState } from '../store';\nimport tileSets from '../services/tileSets';\nimport ClickableTile from './ClickableTile';\n\nfunction Canvas() {\n  const dispatch = useDispatch();\n  const canvas = useSelector((state: RootState) => state.canvas.present.tileMap);\n  const { width, height } = useSelector((state: RootState) => state.canvas.present);\n  const brush = useSelector((state: RootState) => state.tools.brush);\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\n  const tileSet = tileSets[tileSetName];\n\n  function paint(index: number) {\n    dispatch(paintTile(index, brush));\n  }\n\n  function parseTileArray() {\n    return canvas.map((tile: number, index: number) => (\n      <ClickableTile key={index} index={index} onMouseClick={() => paint(index)} />\n    ));\n  }\n\n  return (\n        <Grid\n          columns={width}\n          rows={height}\n          tileHeight={tileSet.tileHeight}\n          tileWidth={tileSet.tileWidth}\n          scale={32 / tileSet.tileWidth} >\n            {parseTileArray()}\n        </Grid>\n  );\n}\n\nexport default Canvas;\n","export interface BrushState {\n  brush: number\n}\n\ninterface BrushAction {\n  type: string,\n  data: {\n    brush: number\n  }\n}\n\nconst initialState: BrushState = {\n  brush: 0,\n};\n\nfunction setTile(state: BrushState, brush: number): BrushState {\n  const newState = { ...state, brush };\n  return newState;\n}\n\nfunction brushReducer(state: BrushState = initialState, action: BrushAction): BrushState {\n  switch (action.type) {\n    case 'SET_BRUSH':\n      return setTile(state, action.data.brush);\n    default:\n      return state;\n  }\n}\n\nexport function setBrush(brush: number): BrushAction {\n  return {\n    type: 'SET_BRUSH',\n    data: { brush },\n  };\n}\n\nexport default brushReducer;\n","import React from 'react';\nimport { IconButton } from '@material-ui/core';\nimport { useDispatch } from 'react-redux';\nimport { Icon } from '@iconify/react';\nimport eraserIcon from '@iconify/icons-mdi/eraser';\nimport { setBrush } from '../../reducers/brushReducer';\n\n\nfunction Eraser() {\n  const dispatch = useDispatch();\n\n  return (\n        <div>\n            <div onClick={() => dispatch(setBrush(-1))}>\n                <IconButton data-testid='eraser-icon'>\n                    <Icon icon={eraserIcon} />\n                </IconButton>\n            </div>\n        </div>\n  );\n}\n\nexport default Eraser;\n","import React from 'react';\nimport { IconButton } from '@material-ui/core';\nimport { useDispatch } from 'react-redux';\nimport UndoIcon from '@material-ui/icons/Undo';\nimport { ActionCreators } from 'redux-undo';\n\nfunction Eraser() {\n  const dispatch = useDispatch();\n\n  return (\n        <div onClick={() => dispatch(ActionCreators.undo())}>\n            <IconButton data-testid='undo-icon'>\n                <UndoIcon />\n            </IconButton>\n        </div>\n  );\n}\n\nexport default Eraser;\n","import React from 'react';\nimport { IconButton } from '@material-ui/core';\nimport { useDispatch } from 'react-redux';\nimport RedoIcon from '@material-ui/icons/Redo';\nimport { ActionCreators } from 'redux-undo';\n\nfunction Eraser() {\n  const dispatch = useDispatch();\n\n  return (\n        <IconButton onClick={() => dispatch(ActionCreators.redo())}>\n            <RedoIcon data-testid='redo-icon' />\n        </IconButton>\n  );\n}\n\nexport default Eraser;\n","import axios from 'axios';\nimport Debug from '../utils/Debug';\nimport { User } from './usersService';\nimport auth from '../utils/auth';\n\nconst url = process.env.NODE_ENV === 'development'\n  ? 'http://localhost:3001'\n  : process.env.REACT_APP_BASE_URL;\n\nexport interface TileMap {\n  id?: string,\n  name: string,\n  width: number,\n  height: number,\n  tileMap: number[],\n  tileSet: string,\n  user: User,\n  likes?: string[]\n}\n\nexport function getAll(): Promise<any> {\n  return axios.get(`${url}/api/maps`)\n    .then((response) => {\n      Debug('maps', response.data);\n      return response.data;\n    });\n}\n\nexport function saveMap(map: TileMap, user: User): Promise<any> {\n  if (map.id && map.user.id === user.id) {\n    return axios.put(`${url}/api/maps/${map.id}`, map, { headers: auth(user.token) })\n      .then((response) => {\n        Debug('maps', response);\n        return response.data;\n      });\n  }\n\n  return axios.post(`${url}/api/maps`, map, { headers: auth(user.token) })\n    .then((response) => {\n      Debug('maps', response);\n      return response.data;\n    });\n}\n\nexport function deleteMap(id: string, token: string): Promise<any> {\n  Debug('deleting map');\n\n  return axios.delete(`${url}/api/maps/${id}`, { headers: auth(token) })\n    .then((response) => {\n      Debug('deleted', response);\n      return response.data;\n    });\n}\n\nexport function likeMap(id:string, token: string): Promise<any> {\n  Debug('liking map: ', id);\n\n  return axios.post(`${url}/api/maps/${id}/like`, null, { headers: auth(token) })\n    .then((response) => {\n      Debug('liked', response);\n      return response.data;\n    });\n}\n\nexport function unlikeMap(id:string, token: string): Promise<any> {\n  Debug('unliking map: ', id);\n\n  return axios.post(`${url}/api/maps/${id}/unlike`, null, { headers: auth(token) })\n    .then((response) => {\n      Debug('unliked', response);\n      return response.data;\n    });\n}\n\nexport default {\n  getAll, saveMap, deleteMap, likeMap, unlikeMap,\n};\n","export interface NotificationsState {\n  message: string,\n  severity: 'success' | 'info' | 'warning' | 'error' | undefined\n}\n\ninterface NotificationsAction {\n  type: string,\n  data: {\n    message: string,\n    severity: 'success' | 'info' | 'warning' | 'error' | undefined\n  }\n}\n\nfunction notificationsReducer(state: NotificationsState | {} = {}, action: NotificationsAction) {\n  switch (action.type) {\n    case 'NOTIFY':\n      return action.data;\n    case 'RESET_NOTIFICATION':\n      return {};\n    default:\n      return state;\n  }\n}\n\nexport function notify(message: string, severity: 'success' | 'info' | 'warning' | 'error' | undefined = undefined) {\n  return {\n    type: 'NOTIFY',\n    data: {\n      message,\n      severity,\n    },\n  };\n}\n\nexport function resetNotifications() {\n  return {\n    type: 'RESET_NOTIFICATION',\n  };\n}\n\nexport default notificationsReducer;\n","import {\n  TileMap, getAll, likeMap as like, unlikeMap as unlike,\n} from '../services/mapsService';\nimport GridEditorThunk from '../utils/GridEditorThunk';\nimport { notify } from './notificationsReducer';\nimport Debug from '../utils/Debug';\n\ninterface MapAction {\n  type: string,\n  data?: {\n    maps?: TileMap[],\n    map?: TileMap\n  }\n}\n\nfunction mapsReducer(state: TileMap[] = [], action: MapAction) {\n  switch (action.type) {\n    case 'SET_MAPS': {\n      return action.data?.maps ? action.data.maps : state;\n    }\n    case 'DELETE_MAP': {\n      const deletedMapId = action.data?.map?.id;\n      return deletedMapId ? state.filter((map) => map.id !== deletedMapId) : state;\n    }\n    case 'SAVE_MAP': {\n      const savedMap = action.data?.map;\n      if (savedMap) {\n        const index = state.reduce(\n          (prevValue, map, i) => (map.id === savedMap.id ? i : prevValue),\n          -1,\n        );\n        if (index >= 0) {\n          return state.map((map, i) => (i === index ? savedMap : map));\n        }\n        return state.concat(savedMap);\n      }\n      return state;\n    }\n    case 'LIKE_MAP': {\n      const likedMap = action.data?.map;\n      if (!likedMap) return state;\n\n      return state.map((map) => (map.id !== likedMap.id ? map : likedMap));\n    }\n    default: {\n      return state;\n    }\n  }\n}\n\nexport function initializeMaps(): GridEditorThunk {\n  return (dispatch) => {\n    getAll()\n      .then((maps) => {\n        dispatch({\n          type: 'SET_MAPS',\n          data: {\n            maps,\n          },\n        });\n      })\n      .catch((error) => {\n        Debug(error);\n        dispatch(notify('Something went wrong while loading maps.', 'error'));\n      });\n  };\n}\n\nexport function setMaps(maps: TileMap[]) {\n  return {\n    type: 'SET_MAPS',\n    data: {\n      maps,\n    },\n  };\n}\n\nexport function deleteMap(map: TileMap) {\n  return {\n    type: 'DELETE_MAP',\n    data: {\n      map,\n    },\n  };\n}\n\nexport function appendMap(map: TileMap) {\n  return {\n    type: 'SAVE_MAP',\n    data: {\n      map,\n    },\n  };\n}\n\nexport function likeMap(id: string, token: string): GridEditorThunk {\n  return (dispatch) => {\n    like(id, token)\n      .then((map) => {\n        dispatch({\n          type: 'LIKE_MAP',\n          data: {\n            map,\n          },\n        });\n      })\n      .catch((error) => {\n        Debug(error);\n        dispatch(notify('Something went wrong while liking the map.', 'error'));\n      });\n  };\n}\n\nexport function unlikeMap(id: string, token: string): GridEditorThunk {\n  return (dispatch) => {\n    unlike(id, token)\n      .then((map) => {\n        dispatch({\n          type: 'LIKE_MAP',\n          data: {\n            map,\n          },\n        });\n      })\n      .catch((error) => {\n        Debug(error);\n        dispatch(notify('Something went wrong while unliking the map.', 'error'));\n      });\n  };\n}\n\nexport default mapsReducer;\n","import React from 'react';\nimport { IconButton } from '@material-ui/core';\nimport { useSelector, useDispatch } from 'react-redux';\nimport SaveIcon from '@material-ui/icons/Save';\nimport { saveMap, TileMap } from '../../services/mapsService';\nimport { RootState } from '../../store';\nimport { appendMap } from '../../reducers/mapsReducer';\nimport { updateMap } from '../../reducers/canvasReducer';\nimport { notify } from '../../reducers/notificationsReducer';\nimport Debug from '../../utils/Debug';\n\nfunction Save() {\n  const dispatch = useDispatch();\n  const tileMap = useSelector((state: RootState) => state.canvas);\n  const user = useSelector((state: RootState) => state.user);\n  const map: TileMap = { ...tileMap.present };\n\n  function save(): void {\n    saveMap(map, user)\n      .then((savedMap) => {\n        Debug('map saved', savedMap);\n        dispatch(updateMap(savedMap));\n        dispatch(appendMap(savedMap));\n        dispatch(notify('Map saved succesfully', 'success'));\n      })\n      .catch((error) => {\n        Debug(error);\n        dispatch(notify('Error occured while saving map', 'error'));\n      });\n  }\n\n  return (\n    <IconButton id='save-button' onClick={() => save()} disabled={!user.token}>\n      <SaveIcon />\n    </IconButton>\n  );\n}\n\nexport default Save;\n","import React from 'react';\nimport { IconButton } from '@material-ui/core';\nimport { useHistory } from 'react-router-dom';\nimport StorageIcon from '@material-ui/icons/Storage';\n\nfunction Load() {\n  const history = useHistory();\n\n  return (\n    <IconButton onClick={() => history.push('/maps')}>\n      <StorageIcon />\n    </IconButton>\n  );\n}\n\nexport default Load;\n","import * as React from 'react';\nimport { Modal, IconButton } from '@material-ui/core';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Grid from '../Grid';\nimport { RootState } from '../../store';\nimport Tile from '../Tile';\nimport { setBrush } from '../../reducers/brushReducer';\nimport tileSets from '../../services/tileSets';\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n  window: {\n    background: theme.palette.background.default,\n    position: 'absolute',\n    zIndex: 0,\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n    transformOrigin: 'center',\n  },\n  brush: {\n    boxShadow: '0px 0px 3px 0px rgba(0,0,0,0.75)',\n  },\n  tile: {\n    position: 'absolute',\n    transition: ' all 0.1s ease-in-out',\n    zIndex: 0,\n    transformOrigin: '50% 50%',\n    '&:hover': {\n      zIndex: 1,\n      cursor: 'pointer',\n      transform: 'scale(1.2)',\n    },\n  },\n}));\n\nexport interface Props {\n  setOpen: Function,\n  open: boolean\n}\n\nfunction Palette() {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\n  const tileSet = tileSets[tileSetName];\n  const { mapping } = tileSet;\n  const brush = useSelector((state: RootState) => state.tools.brush);\n\n  const [open, setOpen] = React.useState(false);\n\n  function palette(): any {\n    return Array(tileSet.tiles).fill(0).map((n: number, index: number) => (\n      <div\n        className={classes.tile}\n        style={{ width: tileSet.tileWidth }}\n        key={index}\n        onClick={() => dispatch(setBrush(index))}>\n        <Tile {...mapping[index]} />\n      </div>\n    ));\n  }\n\n  return (\n    <div>\n      <div onClick={() => setOpen(true)}>\n        <IconButton className={classes.brush} >\n          <Grid\n            columns={1}\n            rows={1}\n            tileHeight={tileSet.tileHeight}\n            tileWidth={tileSet.tileWidth}\n            scale={24 / tileSet.tileWidth} >\n            {brush >= 0\n            && <Tile {...mapping[brush]} />}\n          </Grid>\n        </IconButton>\n      </div>\n\n      <div onClick={() => setOpen(false)}>\n        <Modal open={open} onClose={() => setOpen(false)} >\n          <div className={classes.window} >\n            <Grid\n              columns={tileSet.tilesPerRow}\n              rows={tileSet.tilesPerColumn}\n              tileHeight={tileSet.tileHeight}\n              tileWidth={tileSet.tileWidth}\n              scale={32 / tileSet.tileWidth} >\n              {palette()}\n            </Grid>\n          </div>\n        </Modal>\n      </div>\n    </div>\n  );\n}\n\nexport default Palette;\n","import React, { ReactElement } from 'react';\nimport { List, ListItem } from '@material-ui/core';\nimport Eraser from './Eraser';\nimport Undo from './Undo';\nimport Redo from './Redo';\nimport Save from './Save';\nimport Load from './Load';\nimport Palette from './Palette';\n\n\nconst tools = [\n  <Load key='load' />,\n  <Save key='save' />,\n  <Undo key='undo' />,\n  <Redo key='redo' />,\n  <Eraser key='eraser' />,\n  <Palette key='palette' />,\n];\n\nfunction Tools() {\n  return (\n        <List data-testid='tools'>\n          {tools.map((tool: ReactElement, index: number) => (\n                <ListItem key={index}>\n                  {tool}\n                </ListItem>\n          ))}\n        </List>\n  );\n}\n\nexport default Tools;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  makeStyles, Theme, createStyles, Drawer,\n} from '@material-ui/core';\nimport Tools from './Tools';\nimport { RootState } from '../store';\nimport Debug from '../utils/Debug';\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n  root: {\n    display: 'flex',\n  },\n  appBar: {\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  drawer: {\n    // width: 300,\n    flexShrink: 0,\n  },\n  title: {\n    flexGrow: 1,\n  },\n  tool: {\n    marginRight: '1em',\n  },\n  content: {\n    margin: 'auto',\n  },\n  toolbarMargin: theme.mixins.toolbar,\n}));\n\ninterface Props {\n  image?: string,\n  mapping?: any,\n  children?: React.ReactNode\n}\n\nfunction ToolBar({ children }: Props) {\n  const brush = useSelector((state: RootState) => state.tools.brush);\n  Debug('brush', brush);\n  const classes = useStyles();\n\n  return (\n        <div className={classes.root}>\n\n            <div className={classes.content}>\n\n                <Drawer variant=\"permanent\">\n                  <div className={classes.toolbarMargin} />\n                  <Tools />\n                </Drawer>\n\n                <div className={classes.content}>\n                  {children}\n                </div>\n            </div>\n\n        </div>\n  );\n}\n\nexport default ToolBar;\n","import React from 'react';\nimport {\n  IconButton, Typography, makeStyles, createStyles,\n} from '@material-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\nimport { TileMap } from '../services/mapsService';\nimport { RootState } from '../store';\nimport { likeMap, unlikeMap } from '../reducers/mapsReducer';\nimport { NoUser } from '../services/usersService';\n\ninterface Props {\n  map: TileMap\n}\n\nconst useStyles = makeStyles(() => createStyles({\n  container: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n}));\n\nfunction MapLikeButton({ map }: Props) {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const user = useSelector((state: RootState) => state.user);\n  if (user === NoUser) return null;\n\n  const liked = user.id && map.likes?.includes(user.id);\n\n  const icon = liked\n    ? <FavoriteIcon />\n    : <FavoriteBorderIcon />;\n\n  function like() {\n    if (!map.id) return;\n    if (!liked) {\n      dispatch(likeMap(map.id, user.token));\n    } else {\n      dispatch(unlikeMap(map.id, user.token));\n    }\n  }\n\n  return (\n    <div className={classes.container}>\n        <IconButton data-testid='like-icon' onClick={() => like()}>\n          {icon}\n        </IconButton>\n        <Typography>\n          {map.likes?.length || 0}\n        </Typography>\n    </div>\n  );\n}\n\nexport default MapLikeButton;\n","import React from 'react';\nimport {\n  Card,\n  CardActionArea,\n  CardMedia, CardContent,\n  Typography,\n  CardActions,\n  Button,\n  createStyles,\n  makeStyles,\n} from '@material-ui/core';\nimport { useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ActionCreators } from 'redux-undo';\nimport Grid from './Grid';\nimport { TileMap, deleteMap } from '../services/mapsService';\nimport { deleteMap as cutMap } from '../reducers/mapsReducer';\nimport Tile from './Tile';\nimport { load } from '../reducers/canvasReducer';\nimport tileSets from '../services/tileSets';\nimport { notify } from '../reducers/notificationsReducer';\nimport { RootState } from '../store';\nimport Debug from '../utils/Debug';\nimport MapLikeButton from './MapLikeButton';\n\nconst useStyles = makeStyles(() => createStyles({\n  map: {\n    margin: '1em',\n    minWidth: '11em',\n    maxWidth: '12em',\n  },\n  mapThumbnail: {\n    display: 'flex',\n    height: '10em',\n    overflow: 'hidden',\n    alignItems: 'center',\n    justifyContent: 'center',\n    margin: '0.5em',\n  },\n}));\n\ninterface Props {\n  map: TileMap\n}\n\nfunction MapCard({ map }: Props) {\n  const user = useSelector((state: RootState) => state.user);\n  const history = useHistory();\n  const tileSet = tileSets[map.tileSet];\n  const { mapping } = tileSet;\n  const dispatch = useDispatch();\n  const classes = useStyles();\n\n  function parseMap(mapToParse: TileMap) {\n    return mapToParse.tileMap.map((tile: number, index: number) => (\n      <div key={index}>\n        {tile >= 0 && <Tile {...mapping[tile]} />}\n      </div>\n    ));\n  }\n\n  function removeMap(mapToRemove: TileMap) {\n    dispatch(cutMap(mapToRemove));\n    if (mapToRemove.id) {\n      deleteMap(mapToRemove.id, user.token)\n        .catch((error) => {\n          Debug(error);\n          dispatch(notify('Something went wrong while removing the map.', 'error'));\n        });\n    }\n  }\n\n  function clickHandler() {\n    dispatch(load(map));\n    dispatch(ActionCreators.clearHistory());\n    history.push('/');\n  }\n\n  return (\n    <Card className={classes.map} key={map.name}>\n      <CardActionArea onClick={() => clickHandler()}>\n        <CardMedia>\n          <div className={classes.mapThumbnail}>\n            <Grid\n              rows={map.height}\n              columns={map.width}\n              tileHeight={tileSet.tileHeight}\n              tileWidth={tileSet.tileWidth}\n              scale={8 / tileSet.tileWidth} >\n              {parseMap(map)}\n            </Grid>\n          </div>\n        </CardMedia>\n        <CardContent>\n          <Typography variant='h6'>\n            {map.name}\n          </Typography>\n          <Typography variant='caption'>\n            {map.user && map.user.name}\n          </Typography>\n        </CardContent>\n      </CardActionArea>\n\n      <CardActions>\n        <MapLikeButton map={map} />\n        {\n          user.profile === map.user?.profile\n          && <Button onClick={() => removeMap(map)}>\n            Delete\n          </Button>\n        }\n      </CardActions>\n    </Card>\n  );\n}\n\nexport default MapCard;\n","export interface MapsFilterState {\n  text: string,\n  users: string[]\n}\n\ninterface MapsFilterAction {\n  type: 'SET_FILTER',\n  data: {\n    text: string,\n    users: string[]\n  }\n}\n\nconst initialState = {\n  text: '',\n  users: [],\n};\n\nfunction mapsFilterReducer(\n  state: MapsFilterState = initialState,\n  action: MapsFilterAction,\n): MapsFilterState {\n  switch (action.type) {\n    case 'SET_FILTER':\n      return action.data;\n    default:\n      return state;\n  }\n}\n\nexport function setFilter(filter: MapsFilterState): MapsFilterAction {\n  return {\n    type: 'SET_FILTER',\n    data: filter,\n  };\n}\n\nexport function resetFilter(): MapsFilterAction {\n  return setFilter(initialState);\n}\n\nexport default mapsFilterReducer;\n","import * as React from 'react';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n  TextField, Theme, Select, MenuItem, InputLabel, FormControl,\n} from '@material-ui/core';\nimport { RootState } from '../store';\nimport { User } from '../services/usersService';\nimport { TileMap } from '../services/mapsService';\nimport Debug from '../utils/Debug';\nimport { setFilter } from '../reducers/mapsFilterReducer';\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n  form: {\n    background: theme.palette.background.default,\n    display: 'flex',\n    padding: '2em',\n    alignItems: 'stretch',\n  },\n  searchField: {\n    flex: 'auto',\n    margin: '1em',\n  },\n  userFilter: {\n    flex: 'auto',\n    margin: '1em',\n  },\n}));\n\nfunction MapsFilter() {\n  const dispatch = useDispatch();\n  const maps = useSelector((state: RootState) => state.maps);\n  const mapsFilter = useSelector((state: RootState) => state.mapsFilter);\n  const classes = useStyles();\n\n  // const [searchValue, setSearchValue] = useState('');\n  // const [userFilter, setUserFilter] = useState([] as string[]);\n\n  const users = maps.reduce((usersAcc: User[], map: TileMap) => {\n    if (usersAcc.some((foundUser) => foundUser.id === map.user.id)) {\n      return usersAcc;\n    }\n    return usersAcc.concat(map.user);\n  }, []);\n\n  function changeUserFilter(value: unknown) {\n    Debug('userfilter: ', value);\n    // setUserFilter(value as string[]);\n    dispatch(setFilter({\n      text: mapsFilter.text,\n      users: value as string[],\n    }));\n  }\n\n  function changeTextFilter(value: string) {\n    dispatch(setFilter({\n      text: value,\n      users: mapsFilter.users,\n    }));\n  }\n\n  return (\n      <div className={classes.form} >\n\n        <FormControl fullWidth className={classes.searchField} variant='outlined'>\n          <TextField\n            label='Map search'\n            type='text'\n            size='medium'\n            variant='outlined'\n            value={mapsFilter.text}\n            onChange={(event) => changeTextFilter(event.target.value)} />\n        </FormControl>\n\n        <FormControl fullWidth className={classes.userFilter} variant='outlined'>\n          <InputLabel id='select-tileset-label'>Filter by user</InputLabel>\n          <Select\n            labelId='select-tileset-label'\n            label='Filter by user'\n            autoWidth\n            multiple value={mapsFilter.users}\n            onChange={(event) => changeUserFilter(event.target.value)}>\n\n            {users.map((user) => (\n                  <MenuItem key={user.id} value={user.id}>\n                    {user.name}\n                  </MenuItem>\n            ))}\n\n          </Select>\n        </FormControl>\n\n      </div>\n  );\n}\n\nexport default MapsFilter;\n","import * as React from 'react';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Typography } from '@material-ui/core';\nimport { TileMap } from '../services/mapsService';\nimport { RootState } from '../store';\nimport { initializeMaps } from '../reducers/mapsReducer';\nimport MapCard from './MapCard';\nimport MapsFilter from './MapsFilter';\n\nconst useStyles = makeStyles(() => createStyles({\n  container: {\n    display: 'flex',\n    flex: 'auto',\n    alignItems: 'stretch',\n    flexDirection: 'column',\n    padding: '2em',\n  },\n  filter: {\n    flex: 'auto',\n  },\n  map: {\n    margin: '1em',\n  },\n  mapList: {\n    display: 'flex',\n  },\n}));\n\nfunction Maps() {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    dispatch(initializeMaps());\n  }, [dispatch]);\n\n  const maps = useSelector((state: RootState) => state.maps);\n  const mapsFilter = useSelector((state: RootState) => state.mapsFilter);\n  const classes = useStyles();\n\n  const filterMaps = () => maps.filter((map) => (\n    map.name.toLowerCase().includes(mapsFilter.text.toLowerCase())\n        && (mapsFilter.users.length === 0\n          || (map.user.id && mapsFilter.users.includes(map.user.id)))));\n\n  function parsedMaps() {\n    const filteredMaps = filterMaps();\n    if (filteredMaps.length === 0) return <Typography>No maps were found.</Typography>;\n    return (\n      filteredMaps.map((map: TileMap) => <MapCard key={map.id} map={map} />)\n    );\n  }\n\n  return (\n    <div className={classes.container}>\n      <div>\n        <MapsFilter />\n      </div>\n      <div className={classes.mapList}>\n        {parsedMaps()}\n      </div>\n    </div>\n  );\n}\n\nexport default Maps;\n","import React, { useState } from 'react';\nimport {\n  TextField, makeStyles, Theme, createStyles, Button, Select, MenuItem, InputLabel, FormControl,\n} from '@material-ui/core';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { RootState } from '../../store';\nimport { updateMap, load } from '../../reducers/canvasReducer';\nimport { TileMap } from '../../services/mapsService';\nimport tileSets from '../../services/tileSets';\nimport Debug from '../../utils/Debug';\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n  form: {\n    background: theme.palette.background.default,\n    display: 'grid',\n    gridGap: '2em',\n    padding: '2em',\n  },\n}));\n\ninterface Props {\n  handleSubmit?: Function;\n}\n\nfunction Settings({ handleSubmit }: Props) {\n  const tileMap = useSelector((state: RootState) => state.canvas.present);\n  const tileSetName = useSelector((state: RootState) => state.tileSet);\n  const user = useSelector((state: RootState) => state.user);\n  const dispatch = useDispatch();\n  const classes = useStyles();\n\n  const [name, setName] = useState(tileMap.name);\n  const [width, setWidth] = useState(tileMap.width);\n  const [height, setHeight] = useState(tileMap.height);\n  const [tileSet, setTileSet] = useState(tileSetName);\n\n  const tileSetNames = () => Object.keys(tileSets)\n    .map((key: string) => <MenuItem key={key} value={key}>{key}</MenuItem>);\n\n  const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    Debug(event.target.value);\n    setTileSet(event.target.value as string);\n  };\n\n  const handleSave = (event: React.FormEvent<HTMLButtonElement>) => {\n    event.preventDefault();\n    dispatch(updateMap({\n      ...tileMap, name, width, height, tileSet,\n    }));\n    if (handleSubmit) handleSubmit();\n  };\n\n  const handleCreateNew = (event: React.FormEvent<HTMLButtonElement>) => {\n    event.preventDefault();\n\n    const newMap: TileMap = {\n      tileSet,\n      name: 'New Map',\n      width,\n      height,\n      tileMap: new Array(width * height).fill(-1),\n      user,\n    };\n\n    Debug('creating new map', newMap);\n    dispatch(load(newMap));\n    setName('New Map');\n    if (handleSubmit) handleSubmit();\n  };\n\n  return (\n    <div className={classes.form} >\n      <TextField label='Name' variant='outlined' defaultValue={name} onChange={(event) => setName(event.target.value)} />\n      <TextField label='Width' type='number' variant='outlined' defaultValue={width} onChange={(event) => setWidth(Number.parseInt(event.target.value, 10))} />\n      <TextField label='Height' type='number' variant='outlined' defaultValue={height} onChange={(event) => setHeight(Number.parseInt(event.target.value, 10))} />\n      <FormControl variant='outlined'>\n        <InputLabel id='select-tileset-label'>Tile Set</InputLabel>\n        <Select labelId='select-tileset-label' label='Tileset' value={tileSet} variant='outlined' onChange={(event) => handleChange(event)}>\n          {tileSetNames()}\n        </Select>\n      </FormControl>\n      <Button type=\"submit\" variant='contained' color='primary' onClick={(event) => handleSave(event)} >Apply Changes</Button>\n      <Button type=\"submit\" variant='outlined' onClick={(event) => handleCreateNew(event)} >Create New</Button>\n    </div>\n  );\n}\n\nexport default Settings;\n","import React, { useState } from 'react';\nimport {\n  IconButton, Modal, makeStyles, createStyles,\n} from '@material-ui/core';\n\nimport EditIcon from '@material-ui/icons/Edit';\nimport Settings from './Settings';\n\nconst useStyles = makeStyles(() => createStyles({\n  window: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n    transformOrigin: 'center',\n  },\n}));\n\nfunction Edit() {\n  const [open, setOpen] = useState(false);\n  const classes = useStyles();\n\n  return (\n    <div>\n      <IconButton onClick={() => setOpen(true)}>\n        <EditIcon />\n      </IconButton>\n\n      <Modal open={open} onClose={() => setOpen(false)} >\n        <div className={classes.window} >\n          <Settings handleSubmit={() => setOpen(false)} />\n        </div>\n      </Modal>\n    </div>\n  );\n}\n\nexport default Edit;\n","import { User, NoUser, login as userLogin } from '../services/usersService';\nimport GridEditorThunk from '../utils/GridEditorThunk';\nimport { notify } from './notificationsReducer';\nimport Debug from '../utils/Debug';\n\ninterface UserAction {\n  type: string,\n  data?: User\n}\n\nfunction userReducer(state: User = NoUser, action: UserAction): User {\n  switch (action.type) {\n    case ('LOGIN'):\n      return action.data || state;\n    case ('LOGOUT'):\n      return NoUser;\n    default:\n      return state;\n  }\n}\n\nexport function login(user: User): GridEditorThunk {\n  return (dispatch) => {\n    userLogin(user.token)\n      .then((response) => dispatch({\n        type: 'LOGIN',\n        data: Object.assign(response, user),\n      }))\n      .catch((err) => {\n        Debug(err);\n        dispatch(notify('Error while logging in.', 'error'));\n      });\n  };\n}\n\nexport function logout() {\n  return {\n    type: 'LOGOUT',\n  };\n}\n\nexport default userReducer;\n","import React from 'react';\nimport GoogleLogin from 'react-google-login';\nimport { useDispatch } from 'react-redux';\nimport { login } from '../reducers/userReducer';\nimport Debug from '../utils/Debug';\n\nfunction Login() {\n  const dispatch = useDispatch();\n\n  const responseGoogle = (response: any) => {\n    Debug(response);\n    if (response.error) return;\n    dispatch(login({\n      name: response.profileObj.name,\n      token: response.accessToken,\n      profile: response.googleId,\n    }));\n  };\n\n  return (\n      <GoogleLogin\n        clientId={process.env.REACT_APP_GOOGLE_LOGIN_URL || ''}\n        buttonText=\"Login\"\n        onSuccess={responseGoogle}\n        onFailure={responseGoogle}\n        cookiePolicy={'single_host_origin'}\n        isSignedIn={true}\n      />\n  );\n}\n\nexport default Login;\n","import React from 'react';\nimport { GoogleLogout } from 'react-google-login';\nimport { useDispatch } from 'react-redux';\nimport { logout } from '../reducers/userReducer';\nimport Debug from '../utils/Debug';\n\n\nfunction Logout() {\n  const dispatch = useDispatch();\n\n  const handleLogout = () => {\n    dispatch(logout());\n    Debug('logged out');\n  };\n\n  return (\n    <GoogleLogout\n      clientId=\"566902547666-7bdampp3nip1c2pmp3bh7jp1bocpfg38.apps.googleusercontent.com\"\n      buttonText=\"Logout\"\n      onLogoutSuccess={handleLogout}\n    >\n    </GoogleLogout>\n  );\n}\n\nexport default Logout;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { Switch, Route, useHistory } from 'react-router-dom';\nimport {\n  AppBar, Toolbar, Typography, makeStyles, Theme, createStyles, Grid as MUIGrid, IconButton,\n} from '@material-ui/core';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport { RootState } from '../store';\nimport Edit from './Tools/Edit';\nimport Login from './Login';\nimport Logout from './Logout';\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n  root: {\n    display: 'flex',\n  },\n  appBar: {\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  title: {\n    flexGrow: 1,\n    '&:hover': {\n      cursor: 'pointer',\n    },\n  },\n  content: {\n    margin: 'auto',\n    marginTop: '1em',\n  },\n  toolbarMargin: theme.mixins.toolbar,\n}));\n\ninterface Props {\n  image?: string,\n  mapping?: any,\n  children?: React.ReactNode\n}\n\nfunction TopBar({ children }: Props) {\n  const mapName = useSelector((state: RootState) => state.canvas.present.name);\n  const user = useSelector((state: RootState) => state.user);\n  const history = useHistory();\n  const classes = useStyles();\n\n  const canvasName = () => (\n      <MUIGrid container alignItems='center' >\n        <MUIGrid item >\n          <Edit />\n        </MUIGrid>\n        <MUIGrid item >\n          <Typography variant='h6' display='inline' align='justify'>{mapName}</Typography>\n        </MUIGrid>\n      </MUIGrid>\n  );\n\n  return (\n    <div className={classes.root}>\n\n      <AppBar color='default' position='absolute' className={classes.appBar}>\n        <Toolbar>\n          <MUIGrid\n            container\n            direction=\"row\"\n            justify=\"space-between\"\n            alignItems=\"center\"\n          >\n\n            <MUIGrid item xs={3} >\n              <Typography variant=\"h6\" className={classes.title} onClick={() => history.push('/')}>\n                Grid Editor\n              </Typography>\n            </MUIGrid>\n\n            <MUIGrid item>\n\n                <Switch>\n                  <Route exact path='/login' />\n\n                  <Route exact path='/maps'>\n                    <IconButton onClick={() => history.push('/')}>\n                      <CancelIcon/>\n                    </IconButton>\n                  </Route>\n\n                  <Route exact path='/'>\n                    {canvasName()}\n                  </Route>\n                </Switch>\n\n            </MUIGrid>\n\n            <MUIGrid item xs={3} style={{ textAlign: 'right' }}>\n              {!user.token && <Login />}\n              {user.token && <Logout />}\n            </MUIGrid>\n\n          </MUIGrid>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.content}>\n        <div className={classes.toolbarMargin} />\n        {children}\n      </div>\n\n    </div>\n  );\n}\n\nexport default TopBar;\n","import React from 'react';\nimport { Snackbar } from '@material-ui/core';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Alert } from '@material-ui/lab';\nimport { RootState } from '../store';\nimport { resetNotifications } from '../reducers/notificationsReducer';\n\nfunction Notification() {\n  const notification = useSelector((state: RootState) => state.notification);\n  const dispatch = useDispatch();\n\n  if (!notification.message) return null;\n\n  const handleClose = () => {\n    dispatch(resetNotifications());\n  };\n\n  const alert = () => <Alert severity={notification.severity}>{notification.message}</Alert>;\n\n  return (\n    <Snackbar\n      open={true}\n      onClose={handleClose}\n      autoHideDuration={6000}\n      message={notification.message}\n      anchorOrigin={{ vertical: 'bottom', horizontal: 'left' }}\n    >\n      {notification.severity && alert()}\n    </Snackbar>\n  );\n}\n\nexport default Notification;\n","interface ThemeAction {\n  type: string,\n  data: 'light' | 'dark'\n}\n\nfunction themeReducer(\n  state: 'light' | 'dark' = 'light',\n  action: ThemeAction,\n) {\n  switch (action.type) {\n    case ('CHANGE_THEME'):\n      return action.data;\n    default:\n      return state;\n  }\n}\n\nexport function toggleDarkMode(theme: 'light' | 'dark') {\n  return {\n    type: 'CHANGE_THEME',\n    data: theme,\n  };\n}\n\nexport default themeReducer;\n","import * as React from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\nimport {\n  ThemeProvider, createMuiTheme, CssBaseline, useMediaQuery,\n} from '@material-ui/core';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Canvas from './components/Canvas';\nimport ToolBar from './components/ToolBar';\nimport Maps from './components/Maps';\nimport TopBar from './components/TopBar';\nimport Login from './components/Login';\nimport Notification from './components/Notification';\nimport { RootState } from './store';\nimport { toggleDarkMode } from './reducers/themeReducer';\n\nfunction App() {\n  const dispatch = useDispatch();\n  const type = useSelector((state: RootState) => state.theme);\n  const userPreference = useMediaQuery('(prefers-color-scheme: dark)') ? 'dark' : 'light';\n\n  if (type !== userPreference) {\n    dispatch(toggleDarkMode(userPreference));\n  }\n\n  const theme = createMuiTheme({\n    palette: {\n      type,\n    },\n  });\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <Router>\n        <TopBar>\n          <Switch>\n            <Route exact path='/login'><Login /></Route>\n            <Route exact path='/'>\n              <ToolBar>\n                <Canvas />\n              </ToolBar>\n            </Route>\n            <Route path='/maps'><Maps /></Route>\n          </Switch>\n        </TopBar>\n        <Notification />\n      </Router>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import { TileMap } from '../services/mapsService';\nimport Debug from '../utils/Debug';\n\nexport interface TileSetAction {\n  type: string,\n  data: {\n    tileSet?: string,\n    tileMap?: TileMap\n  }\n}\n\nfunction tileSetReducer(state: string = 'Harbour', action: TileSetAction) {\n  switch (action.type) {\n    case 'SET_TILESET':\n      return action.data.tileSet || state;\n    case 'LOAD_MAP':\n    case 'UPDATE_MAP':\n      Debug('TileSet', action.data);\n      return action.data?.tileMap ? action.data.tileMap.tileSet : state;\n    default:\n      return state;\n  }\n}\n\nexport function setTileSet(tileSet: string) {\n  return {\n    type: 'SET_TILESET',\n    data: { tileSet },\n  };\n}\n\nexport default tileSetReducer;\n","import { createStore, combineReducers, applyMiddleware } from 'redux';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport thunk from 'redux-thunk';\nimport { StateWithHistory } from 'redux-undo';\nimport canvasReducer from './reducers/canvasReducer';\nimport brushReducer, { BrushState } from './reducers/brushReducer';\nimport tileSetReducer from './reducers/tileSetReducer';\nimport mapsReducer from './reducers/mapsReducer';\nimport { TileMap } from './services/mapsService';\nimport userReducer from './reducers/userReducer';\nimport notificationsReducer, { NotificationsState } from './reducers/notificationsReducer';\nimport themeReducer from './reducers/themeReducer';\nimport Debug from './utils/Debug';\nimport { User } from './services/usersService';\nimport mapsFilterReducer, { MapsFilterState } from './reducers/mapsFilterReducer';\n\nexport interface RootState {\n  user: User,\n  tileSet: string,\n  canvas: StateWithHistory<TileMap>,\n  tools: BrushState,\n  maps: TileMap[],\n  mapsFilter: MapsFilterState,\n  notification: NotificationsState,\n  theme: 'dark' | 'light'\n}\n\nconst reducer = combineReducers({\n  user: userReducer,\n  tileSet: tileSetReducer,\n  canvas: canvasReducer,\n  tools: brushReducer,\n  maps: mapsReducer,\n  mapsFilter: mapsFilterReducer,\n  notification: notificationsReducer,\n  theme: themeReducer,\n});\n\nconst store = createStore(\n  reducer,\n  composeWithDevTools(\n    applyMiddleware(thunk),\n  ),\n);\nDebug('store', store.getState());\n\nexport default store;\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport App from './App';\nimport store from './store';\n\nconst render = () => {\n  ReactDOM.render(\n  <Provider store={store} >\n    <App />\n  </Provider>,\n  document.getElementById('root'),\n  );\n};\n\nrender();\n// store.subscribe(render);\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACd0lEQVR42u1a2Y6EMAzj/3969mlH2lHbOLaTdmGQkPagEFzHubiu63qtzuojen7DGV/0aAC+DGg8VQDJtZxhyLWRYaO1nQDaGaBS+3edyoAyEVw9hKXlvwOgYudnALAMTK3LIov6N2PM6BkzlmTvmQZg9JKM8DgY8AnGChzErawa0AEAygRqnSoupzMgdImsC5ysARQAqrrelgFuDRjdIxIshwbYXcDBgCgVbmVANr1lqR3tble1OWRAZX6PZpJq9ogWbVMAUDSrGMBmdeUAOKtEZxXY5gJuABQGOER4CcCudtVWAHa0sZwgbwfghC6S7AKndG27Gi/Hd4XVxmwaAGb3KxiC9BvRtngZAFFRFP2uJFJIvUJsoJZ2Ii+fASAzL0ASKICtXKyuEkm0aMowJLCdz8GVmsANALppg79zWdpJDBD/70mD3cORtnNEi2yJnDE+cqeZ324DwMmAKM5vB2AWPtA4jLStkXKZHYFRXWgnAO4BKRuSU3a4XEDRgKjjO/tZmSq/r3WJoKIBaMsbcSOk8/RxrS8MshrAAIACEoKFagD7UgyDlMlTGhAXAEh4y9w/01KL6B8USJoLqBMfdvDB6MEQACcDZrlBR/c4sntqm1MDGIo7gBDZ63GBzBjcXU2imze0pyIKuAFAtQIVvj/XdoXBrn4CCox1MuQaWihfqkrVYHbXs3lAppqs6D4Fa+tbWFEcR+K6UnAtAYw0APEpJg/Ifv7mdNWyz+UFIyTKix1qPIFRR+CZ9Lcyo6Q1gH35lctsH7WHiULjJNjVjk92rePBwd2PKIQ9A4BFnL4/AI93gShMPAKARVr6LAaMvqP7AnDj4weKUYv+/6aLvgAAAABJRU5ErkJggg==\""],"sourceRoot":""}